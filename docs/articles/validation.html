<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ph2rand: Validation • ph2rand</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ph2rand: Validation">
<meta property="og:description" content="ph2rand">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ph2rand</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ph2rand.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/validation.html">ph2rand: Validation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mjg211/ph2rand/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="validation_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ph2rand: Validation</h1>
                        <h4 class="author">Michael J Grayling (<a href="mailto:michael.grayling@newcastle.ac.uk" class="email">michael.grayling@newcastle.ac.uk</a>)</h4>
            
            <h4 class="date">2020-09-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mjg211/ph2rand/blob/master/vignettes/validation.Rmd"><code>vignettes/validation.Rmd</code></a></small>
      <div class="hidden name"><code>validation.Rmd</code></div>

    </div>

    
    
<div id="using-sim-to-confirm-design-operating-characteristics" class="section level1">
<h1 class="hasAnchor">
<a href="#using-sim-to-confirm-design-operating-characteristics" class="anchor"></a>1. Using <code>sim()</code> to confirm design operating characteristics</h1>
<p>All exported commands in <strong>ph2rand</strong>, with the exception of <code><a href="../reference/sim.html">sim()</a></code>, rely on a number of underlying modules to perform the required calculations analytically (i.e., exactly, using binomial densities), without recourse to simulation. Therefore, while good programming practices have been implemented to minimise potential bugs, and all code has been tested extensively, to provide greater assurance that any returned design has the anticipated operating characteristics, the function <code><a href="../reference/sim.html">sim()</a></code> has also been made available.</p>
<p><code><a href="../reference/sim.html">sim()</a></code> operates in a different manner, not calling any of the other sub-modules used by the other exported commands; it uses a simple simulation study to estimate a design’s operating characteristics. In this vignette, we provide an example on how to use <code><a href="../reference/sim.html">sim()</a></code> to acquire some degree of increased confidence in identified designs. In addition, we also provide code that seeks to reproduce results from previous relevant articles using <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> and <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code>; this code also serves to increase confidence in <strong>ph2rand</strong>.</p>
<div id="example-two-stage-design-from-jung-2008" class="section level2">
<h2 class="hasAnchor">
<a href="#example-two-stage-design-from-jung-2008" class="anchor"></a>2. Example: Two-stage design from Jung (2008)</h2>
<p>As explained in <code><a href="../articles/ph2rand.html">vignette("ph2rand")</a></code>, the default two-stage design can be found with</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw">des_jung</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>()
</pre></div>
<p>The operating characteristics under the null and alternative are then available with</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">des_jung</span><span class="op">$</span><span class="kw">opchar</span>
</pre></div>
<pre><code>## # A tibble: 2 x 13
##     piC   piE `P(pi)` `ESS(pi)` `SDSS(pi)` `MSS(pi)` `E1(pi)` `E2(pi)` `F1(pi)`
##   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1   0.1   0.1  0.0702      47.0       16.5        34        0   0.0702   0.617 
## 2   0.1   0.3  0.813       64.7       10.1        68        0   0.813    0.0972
## # … with 4 more variables: `F2(pi)` &lt;dbl&gt;, `S1(pi)` &lt;dbl&gt;, `S2(pi)` &lt;dbl&gt;, `max
## #   N` &lt;int&gt;</code></pre>
<p>These can be re-evaluated using simulation by calling <code><a href="../reference/sim.html">sim()</a></code> as follows</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">sim_jung</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim.html">sim</a></span>(<span class="kw">des_jung</span>, replicates = <span class="fl">1e5</span>)
<span class="kw">sim_jung</span><span class="op">$</span><span class="kw">sim</span>
</pre></div>
<pre><code>## # A tibble: 2 x 13
##     piC   piE `P(pi)` `ESS(pi)` `SDSS(pi)` `MSS(pi)` `E1(pi)` `E2(pi)` `F1(pi)`
##   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1   0.1   0.1  0.0708      47.1       16.5        34        0   0.0708   0.616 
## 2   0.1   0.3  0.812       64.7       10.1        68        0   0.812    0.0969
## # … with 4 more variables: `F2(pi)` &lt;dbl&gt;, `S1(pi)` &lt;dbl&gt;, `S2(pi)` &lt;dbl&gt;, `max
## #   N` &lt;int&gt;</code></pre>
<p>As can be seen, the estimated operating characteristics are almost identical allowing for simulation error.</p>
</div>
</div>
<div id="reproducing-results-from-previous-publications" class="section level1">
<h1 class="hasAnchor">
<a href="#reproducing-results-from-previous-publications" class="anchor"></a>3. Reproducing results from previous publications</h1>
<div id="jung-2008" class="section level2">
<h2 class="hasAnchor">
<a href="#jung-2008" class="anchor"></a>3.1. Jung (2008)</h2>
<p>We begin by providing code to reproduce results Jung (2008). First, we can reproduce Table I with</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">fact</span>              <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.1</span>, <span class="fl">0.75</span>, <span class="fl">0.05</span>), each = <span class="fl">2</span>)
<span class="kw">p0p1</span>              <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.15</span>),
                           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.20</span>),
                           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.25</span>),
                           <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">fact</span>, <span class="kw">fact</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.15</span>, <span class="fl">0.2</span>), <span class="fl">14</span>)),
                           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.80</span>, <span class="fl">0.95</span>),
                           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.85</span>, <span class="fl">0.95</span>))
<span class="co"># Table I</span>
<span class="kw">table_I</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">p0p1</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>), <span class="fl">11</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">table_I</span>) <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"p0"</span>, <span class="st">"p1"</span>, <span class="st">"Single-stage design: (n,a)"</span>,
                       <span class="st">"Single-stage design: alpha"</span>,
                       <span class="st">"Single-stage design: 1-beta"</span>,
                       <span class="st">"Minimax design: (n,n1,a1,a)"</span>, <span class="st">"Minimax design: alpha"</span>,
                       <span class="st">"Minimax design: 1-beta"</span>, <span class="st">"Minimax design: EN"</span>,
                       <span class="st">"Optimal design: (n,n1,a1,a)"</span>, <span class="st">"Optimal design: alpha"</span>,
                       <span class="st">"Optimal design: 1-beta"</span>, <span class="st">"Optimal design: EN"</span>)
<span class="kw">table_I</span>           <span class="op">&lt;-</span> <span class="kw">tibble</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw">table_I</span>)
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(alpha = <span class="fl">0.15</span>,
                                   beta  = <span class="fl">0.2</span>,
                                   delta = <span class="kw">table_I</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_I</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   Pi0   = <span class="kw">table_I</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   Pi1   = <span class="kw">table_I</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   nCmax = <span class="fl">100L</span>)
  <span class="kw">table_I</span><span class="op">$</span><span class="kw">`Single-stage design: (n,a)`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>, <span class="st">","</span>,
                                                     <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">e1</span>, <span class="st">")"</span>)
  <span class="kw">table_I</span><span class="op">$</span><span class="kw">`Single-stage design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_I</span><span class="op">$</span><span class="kw">`Single-stage design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table I single-stage design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>             <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">50</span>, <span class="fl">22</span>, <span class="fl">16</span>, <span class="fl">38</span>, <span class="fl">24</span>, <span class="fl">46</span>, <span class="fl">32</span>, <span class="fl">57</span>, <span class="fl">33</span>, <span class="fl">67</span>, <span class="fl">39</span>, <span class="fl">70</span>, <span class="fl">41</span>,
                           <span class="fl">78</span>, <span class="fl">42</span>, <span class="fl">78</span>, <span class="fl">45</span>, <span class="fl">78</span>, <span class="fl">46</span>, <span class="fl">78</span>, <span class="fl">45</span>, <span class="fl">77</span>, <span class="fl">43</span>, <span class="fl">76</span>, <span class="fl">40</span>, <span class="fl">68</span>,
                           <span class="fl">38</span>, <span class="fl">63</span>, <span class="fl">33</span>, <span class="fl">52</span>, <span class="fl">29</span>, <span class="fl">42</span>, <span class="fl">76</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.15</span>,
                                   beta    = <span class="fl">0.2</span>,
                                   delta   = <span class="kw">table_I</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_I</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   Pi0     = <span class="kw">table_I</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   Pi1     = <span class="kw">table_I</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   equal   = <span class="fl">FALSE</span>,
                                   w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>),
                                   nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_I</span><span class="op">$</span><span class="kw">`Minimax design: (n,n1,a1,a)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">","</span>,
           <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">f1</span> <span class="op">+</span> <span class="fl">1</span>, <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">e2</span>, <span class="st">")"</span>)
  <span class="kw">table_I</span><span class="op">$</span><span class="kw">`Minimax design: alpha`</span>[<span class="kw">i</span>]       <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_I</span><span class="op">$</span><span class="kw">`Minimax design: 1-beta`</span>[<span class="kw">i</span>]      <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_I</span><span class="op">$</span><span class="kw">`Minimax design: EN`</span>[<span class="kw">i</span>]          <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table I minimax design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>             <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">57</span>, <span class="fl">27</span>, <span class="fl">22</span>, <span class="fl">56</span>, <span class="fl">28</span>, <span class="fl">51</span>, <span class="fl">32</span>, <span class="fl">66</span>, <span class="fl">39</span>, <span class="fl">78</span>, <span class="fl">43</span>, <span class="fl">77</span>, <span class="fl">46</span>,
                           <span class="fl">95</span>, <span class="fl">50</span>, <span class="fl">90</span>, <span class="fl">49</span>, <span class="fl">90</span>, <span class="fl">49</span>, <span class="fl">90</span>, <span class="fl">53</span>, <span class="fl">90</span>, <span class="fl">48</span>, <span class="fl">89</span>, <span class="fl">45</span>, <span class="fl">75</span>,
                           <span class="fl">44</span>, <span class="fl">73</span>, <span class="fl">36</span>, <span class="fl">60</span>, <span class="fl">33</span>, <span class="fl">46</span>, <span class="fl">89</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.15</span>,
                                   beta    = <span class="fl">0.2</span>,
                                   delta   = <span class="kw">table_I</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_I</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   Pi0     = <span class="kw">table_I</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   Pi1     = <span class="kw">table_I</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   equal   = <span class="fl">FALSE</span>,
                                   w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>),
                                   nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_I</span><span class="op">$</span><span class="kw">`Optimal design: (n,n1,a1,a)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">","</span>,
           <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">f1</span> <span class="op">+</span> <span class="fl">1</span>, <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">e2</span>, <span class="st">")"</span>)
  <span class="kw">table_I</span><span class="op">$</span><span class="kw">`Optimal design: alpha`</span>[<span class="kw">i</span>]       <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_I</span><span class="op">$</span><span class="kw">`Optimal design: 1-beta`</span>[<span class="kw">i</span>]      <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_I</span><span class="op">$</span><span class="kw">`Optimal design: EN`</span>[<span class="kw">i</span>]          <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table I optimal design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
</pre></div>
<p>Note that when searching for the minimax and optimal designs we allow the control arm sample size to be up to 10% larger than that given in Table I of Jung (2008). This approach will be taken where relevant throughout this vignette.</p>
<p>To reproduce Tables II-IV, we can use</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">table_II</span>            <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">p0p1</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>), <span class="fl">11</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">table_II</span>)  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"p0"</span>, <span class="st">"p1"</span>, <span class="st">"Single-stage design: (n,a)"</span>,
                        <span class="st">"Single-stage design: alpha"</span>,
                        <span class="st">"Single-stage design: 1-beta"</span>,
                        <span class="st">"Minimax design: (n,n1,a1,a)"</span>, <span class="st">"Minimax design: alpha"</span>,
                        <span class="st">"Minimax design: 1-beta"</span>, <span class="st">"Minimax design: EN"</span>,
                        <span class="st">"Optimal design: (n,n1,a1,a)"</span>, <span class="st">"Optimal design: alpha"</span>,
                        <span class="st">"Optimal design: 1-beta"</span>, <span class="st">"Optimal design: EN"</span>)
<span class="kw">table_II</span>            <span class="op">&lt;-</span> <span class="kw">tibble</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw">table_II</span>)
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>             <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(alpha = <span class="fl">0.15</span>,
                                     beta  = <span class="fl">0.15</span>,
                                     delta = <span class="kw">table_II</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_II</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi0   = <span class="kw">table_II</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi1   = <span class="kw">table_II</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     nCmax = <span class="fl">100L</span>)
  <span class="kw">table_II</span><span class="op">$</span><span class="kw">`Single-stage design: (n,a)`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>, <span class="st">","</span>,
                                                     <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">e1</span>, <span class="st">")"</span>)
  <span class="kw">table_II</span><span class="op">$</span><span class="kw">`Single-stage design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_II</span><span class="op">$</span><span class="kw">`Single-stage design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table II single-stage design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>               <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">58</span>, <span class="fl">34</span>, <span class="fl">19</span>, <span class="fl">49</span>, <span class="fl">28</span>, <span class="fl">62</span>, <span class="fl">36</span>, <span class="fl">74</span>, <span class="fl">43</span>, <span class="fl">78</span>, <span class="fl">46</span>, <span class="fl">87</span>, <span class="fl">50</span>,
                           <span class="fl">91</span>, <span class="fl">54</span>, <span class="fl">98</span>, <span class="fl">54</span>, <span class="fl">98</span>, <span class="fl">54</span>, <span class="fl">98</span>, <span class="fl">54</span>, <span class="fl">96</span>, <span class="fl">53</span>, <span class="fl">88</span>, <span class="fl">51</span>, <span class="fl">83</span>,
                           <span class="fl">44</span>, <span class="fl">73</span>, <span class="fl">41</span>, <span class="fl">67</span>, <span class="fl">32</span>, <span class="fl">53</span>, <span class="fl">95</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>             <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.15</span>,
                                     beta    = <span class="fl">0.15</span>,
                                     delta   = <span class="kw">table_II</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_II</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi0     = <span class="kw">table_II</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi1     = <span class="kw">table_II</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     equal   = <span class="fl">FALSE</span>,
                                     w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>),
                                     nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_II</span><span class="op">$</span><span class="kw">`Minimax design: (n,n1,a1,a)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">","</span>,
           <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">f1</span> <span class="op">+</span> <span class="fl">1</span>, <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">e2</span>, <span class="st">")"</span>)
  <span class="kw">table_II</span><span class="op">$</span><span class="kw">`Minimax design: alpha`</span>[<span class="kw">i</span>]       <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_II</span><span class="op">$</span><span class="kw">`Minimax design: 1-beta`</span>[<span class="kw">i</span>]      <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_II</span><span class="op">$</span><span class="kw">`Minimax design: EN`</span>[<span class="kw">i</span>]          <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table II minimax design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>               <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">69</span>, <span class="fl">34</span>, <span class="fl">22</span>, <span class="fl">59</span>, <span class="fl">32</span>, <span class="fl">73</span>, <span class="fl">44</span>, <span class="fl">89</span>, <span class="fl">45</span>, <span class="fl">87</span>, <span class="fl">52</span>, <span class="fl">98</span>, <span class="fl">55</span>,
                           <span class="fl">103</span>, <span class="fl">63</span>, <span class="fl">112</span>, <span class="fl">61</span>, <span class="fl">109</span>, <span class="fl">63</span>, <span class="fl">100</span>, <span class="fl">60</span>, <span class="fl">107</span>, <span class="fl">60</span>, <span class="fl">99</span>, <span class="fl">55</span>,
                           <span class="fl">94</span>, <span class="fl">49</span>, <span class="fl">82</span>, <span class="fl">47</span>, <span class="fl">69</span>, <span class="fl">37</span>, <span class="fl">60</span>, <span class="fl">103</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>             <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.15</span>,
                                     beta    = <span class="fl">0.15</span>,
                                     delta   = <span class="kw">table_II</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_II</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi0     = <span class="kw">table_II</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi1     = <span class="kw">table_II</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     equal   = <span class="fl">FALSE</span>,
                                     w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>),
                                     nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_II</span><span class="op">$</span><span class="kw">`Optimal design: (n,n1,a1,a)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">","</span>,
           <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">f1</span> <span class="op">+</span> <span class="fl">1</span>, <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">e2</span>, <span class="st">")"</span>)
  <span class="kw">table_II</span><span class="op">$</span><span class="kw">`Optimal design: alpha`</span>[<span class="kw">i</span>]       <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_II</span><span class="op">$</span><span class="kw">`Optimal design: 1-beta`</span>[<span class="kw">i</span>]      <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_II</span><span class="op">$</span><span class="kw">`Optimal design: EN`</span>[<span class="kw">i</span>]          <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table II optimal design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="co"># Table III</span>
<span class="kw">table_III</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">p0p1</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>), <span class="fl">11</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">table_III</span>) <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"p0"</span>, <span class="st">"p1"</span>, <span class="st">"Single-stage design: (n,a)"</span>,
                         <span class="st">"Single-stage design: alpha"</span>,
                         <span class="st">"Single-stage design: 1-beta"</span>,
                         <span class="st">"Minimax design: (n,n1,a1,a)"</span>, <span class="st">"Minimax design: alpha"</span>,
                         <span class="st">"Minimax design: 1-beta"</span>, <span class="st">"Minimax design: EN"</span>,
                         <span class="st">"Optimal design: (n,n1,a1,a)"</span>, <span class="st">"Optimal design: alpha"</span>,
                         <span class="st">"Optimal design: 1-beta"</span>, <span class="st">"Optimal design: EN"</span>)
<span class="kw">table_III</span>           <span class="op">&lt;-</span> <span class="kw">tibble</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw">table_III</span>)
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>             <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(alpha = <span class="fl">0.2</span>,
                                     beta  = <span class="fl">0.2</span>,
                                     delta = <span class="kw">table_III</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_III</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi0   = <span class="kw">table_III</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi1   = <span class="kw">table_III</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     nCmax = <span class="fl">100L</span>)
  <span class="kw">table_III</span><span class="op">$</span><span class="kw">`Single-stage design: (n,a)`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>, <span class="st">","</span>,
                                                      <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">e1</span>, <span class="st">")"</span>)
  <span class="kw">table_III</span><span class="op">$</span><span class="kw">`Single-stage design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_III</span><span class="op">$</span><span class="kw">`Single-stage design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table III single-stage design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>               <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">41</span>, <span class="fl">22</span>, <span class="fl">16</span>, <span class="fl">34</span>, <span class="fl">17</span>, <span class="fl">41</span>, <span class="fl">25</span>, <span class="fl">48</span>, <span class="fl">27</span>, <span class="fl">53</span>, <span class="fl">32</span>, <span class="fl">60</span>, <span class="fl">35</span>,
                           <span class="fl">60</span>, <span class="fl">35</span>, <span class="fl">62</span>, <span class="fl">35</span>, <span class="fl">64</span>, <span class="fl">35</span>, <span class="fl">64</span>, <span class="fl">35</span>, <span class="fl">61</span>, <span class="fl">34</span>, <span class="fl">58</span>, <span class="fl">33</span>, <span class="fl">57</span>,
                           <span class="fl">32</span>, <span class="fl">49</span>, <span class="fl">26</span>, <span class="fl">43</span>, <span class="fl">23</span>, <span class="fl">33</span>, <span class="fl">63</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>             <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.2</span>,
                                     beta    = <span class="fl">0.2</span>,
                                     delta   = <span class="kw">table_III</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span>
                                       <span class="kw">table_III</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi0     = <span class="kw">table_III</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi1     = <span class="kw">table_III</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     equal   = <span class="fl">FALSE</span>,
                                     w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>),
                                     nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_III</span><span class="op">$</span><span class="kw">`Minimax design: (n,n1,a1,a)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">","</span>,
           <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">f1</span> <span class="op">+</span> <span class="fl">1</span>, <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">e2</span>, <span class="st">")"</span>)
  <span class="kw">table_III</span><span class="op">$</span><span class="kw">`Minimax design: alpha`</span>[<span class="kw">i</span>]       <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_III</span><span class="op">$</span><span class="kw">`Minimax design: 1-beta`</span>[<span class="kw">i</span>]      <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_III</span><span class="op">$</span><span class="kw">`Minimax design: EN`</span>[<span class="kw">i</span>]          <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table III minimax design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>               <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">42</span>, <span class="fl">27</span>, <span class="fl">18</span>, <span class="fl">35</span>, <span class="fl">18</span>, <span class="fl">42</span>, <span class="fl">28</span>, <span class="fl">53</span>, <span class="fl">29</span>, <span class="fl">56</span>, <span class="fl">35</span>, <span class="fl">68</span>, <span class="fl">41</span>,
                           <span class="fl">67</span>, <span class="fl">38</span>, <span class="fl">69</span>, <span class="fl">39</span>, <span class="fl">69</span>, <span class="fl">38</span>, <span class="fl">67</span>, <span class="fl">38</span>, <span class="fl">66</span>, <span class="fl">37</span>, <span class="fl">63</span>, <span class="fl">36</span>, <span class="fl">69</span>,
                           <span class="fl">38</span>, <span class="fl">51</span>, <span class="fl">28</span>, <span class="fl">47</span>, <span class="fl">24</span>, <span class="fl">34</span>, <span class="fl">69</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>             <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.2</span>,
                                     beta    = <span class="fl">0.2</span>,
                                     delta   = <span class="kw">table_III</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span>
                                       <span class="kw">table_III</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi0     = <span class="kw">table_III</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi1     = <span class="kw">table_III</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     equal   = <span class="fl">FALSE</span>,
                                     w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>),
                                     nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_III</span><span class="op">$</span><span class="kw">`Optimal design: (n,n1,a1,a)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">","</span>,
           <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">f1</span> <span class="op">+</span> <span class="fl">1</span>, <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">e2</span>, <span class="st">")"</span>)
  <span class="kw">table_III</span><span class="op">$</span><span class="kw">`Optimal design: alpha`</span>[<span class="kw">i</span>]       <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_III</span><span class="op">$</span><span class="kw">`Optimal design: 1-beta`</span>[<span class="kw">i</span>]      <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_III</span><span class="op">$</span><span class="kw">`Optimal design: EN`</span>[<span class="kw">i</span>]          <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table III ptimal design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="co"># Table IV</span>
<span class="kw">table_IV</span>            <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">p0p1</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>), <span class="fl">11</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">table_IV</span>)  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"p0"</span>, <span class="st">"p1"</span>, <span class="st">"Single-stage design: (n,a)"</span>,
                         <span class="st">"Single-stage design: alpha"</span>,
                         <span class="st">"Single-stage design: 1-beta"</span>,
                         <span class="st">"Minimax design: (n,n1,a1,a)"</span>, <span class="st">"Minimax design: alpha"</span>,
                         <span class="st">"Minimax design: 1-beta"</span>, <span class="st">"Minimax design: EN"</span>,
                         <span class="st">"Optimal design: (n,n1,a1,a)"</span>, <span class="st">"Optimal design: alpha"</span>,
                         <span class="st">"Optimal design: 1-beta"</span>, <span class="st">"Optimal design: EN"</span>)
<span class="kw">table_IV</span>            <span class="op">&lt;-</span> <span class="kw">tibble</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw">table_IV</span>)
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>             <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(alpha = <span class="fl">0.2</span>,
                                     beta  = <span class="fl">0.15</span>,
                                     delta = <span class="kw">table_IV</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_IV</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi0   = <span class="kw">table_IV</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi1   = <span class="kw">table_IV</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     nCmax = <span class="fl">100L</span>)
  <span class="kw">table_IV</span><span class="op">$</span><span class="kw">`Single-stage design: (n,a)`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>, <span class="st">","</span>,
                                                       <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">e1</span>, <span class="st">")"</span>)
  <span class="kw">table_IV</span><span class="op">$</span><span class="kw">`Single-stage design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_IV</span><span class="op">$</span><span class="kw">`Single-stage design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table IV single-stage design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>               <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">58</span>, <span class="fl">26</span>, <span class="fl">19</span>, <span class="fl">40</span>, <span class="fl">27</span>, <span class="fl">53</span>, <span class="fl">30</span>, <span class="fl">58</span>, <span class="fl">36</span>, <span class="fl">67</span>, <span class="fl">39</span>, <span class="fl">70</span>, <span class="fl">40</span>,
                           <span class="fl">78</span>, <span class="fl">43</span>, <span class="fl">80</span>, <span class="fl">47</span>, <span class="fl">80</span>, <span class="fl">47</span>, <span class="fl">80</span>, <span class="fl">47</span>, <span class="fl">78</span>, <span class="fl">44</span>, <span class="fl">75</span>, <span class="fl">39</span>, <span class="fl">66</span>,
                           <span class="fl">36</span>, <span class="fl">62</span>, <span class="fl">34</span>, <span class="fl">50</span>, <span class="fl">26</span>, <span class="fl">42</span>, <span class="fl">73</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>             <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.2</span>,
                                     beta    = <span class="fl">0.15</span>,
                                     delta   = <span class="kw">table_IV</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_IV</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi0     = <span class="kw">table_IV</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi1     = <span class="kw">table_IV</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     equal   = <span class="fl">FALSE</span>,
                                     w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>),
                                     nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_IV</span><span class="op">$</span><span class="kw">`Minimax design: (n,n1,a1,a)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">","</span>,
           <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">f1</span> <span class="op">+</span> <span class="fl">1</span>, <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">e2</span>, <span class="st">")"</span>)
  <span class="kw">table_IV</span><span class="op">$</span><span class="kw">`Minimax design: alpha`</span>[<span class="kw">i</span>]       <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_IV</span><span class="op">$</span><span class="kw">`Minimax design: 1-beta`</span>[<span class="kw">i</span>]      <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_IV</span><span class="op">$</span><span class="kw">`Minimax design: EN`</span>[<span class="kw">i</span>]          <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table IV minimax design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>               <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">70</span>, <span class="fl">27</span>, <span class="fl">22</span>, <span class="fl">43</span>, <span class="fl">27</span>, <span class="fl">59</span>, <span class="fl">32</span>, <span class="fl">61</span>, <span class="fl">40</span>, <span class="fl">74</span>, <span class="fl">43</span>, <span class="fl">78</span>, <span class="fl">45</span>,
                           <span class="fl">85</span>, <span class="fl">45</span>, <span class="fl">90</span>, <span class="fl">49</span>, <span class="fl">94</span>, <span class="fl">53</span>, <span class="fl">94</span>, <span class="fl">50</span>, <span class="fl">85</span>, <span class="fl">45</span>, <span class="fl">77</span>, <span class="fl">41</span>, <span class="fl">71</span>,
                           <span class="fl">39</span>, <span class="fl">69</span>, <span class="fl">42</span>, <span class="fl">54</span>, <span class="fl">27</span>, <span class="fl">46</span>, <span class="fl">79</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>             <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.2</span>,
                                     beta    = <span class="fl">0.15</span>,
                                     delta   = <span class="kw">table_IV</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_IV</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi0     = <span class="kw">table_IV</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     Pi1     = <span class="kw">table_IV</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                     equal   = <span class="fl">FALSE</span>,
                                     w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>),
                                     nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_IV</span><span class="op">$</span><span class="kw">`Optimal design: (n,n1,a1,a)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span>
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">","</span>,
           <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">f1</span> <span class="op">+</span> <span class="fl">1</span>, <span class="st">","</span>, <span class="kw">des_i</span><span class="op">$</span><span class="kw">boundaries</span><span class="op">$</span><span class="kw">e2</span>, <span class="st">")"</span>)
  <span class="kw">table_IV</span><span class="op">$</span><span class="kw">`Optimal design: alpha`</span>[<span class="kw">i</span>]       <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_IV</span><span class="op">$</span><span class="kw">`Optimal design: 1-beta`</span>[<span class="kw">i</span>]      <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_IV</span><span class="op">$</span><span class="kw">`Optimal design: EN`</span>[<span class="kw">i</span>]          <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table IV optimal design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
</pre></div>
<p>Note that Jung (2008) does not make it clear exactly how minimax designs are specified, i.e., how a choice between designs with the same minimal maximal sample size is made. Therefore, some differences may appear between identified minimax designs.</p>
<p>Finally, the designs of Examples 1-2 and from Section 3.2 can be reproduced with</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="co"># Example 1</span>
<span class="kw">single_stage</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(alpha = <span class="fl">0.15</span>,
                              beta  = <span class="fl">0.2</span>,
                              Pi0   = <span class="fl">0.7</span>,
                              Pi1   = <span class="fl">0.7</span>,
                              delta = <span class="fl">0.15</span>)
<span class="kw">minimax</span>      <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha = <span class="fl">0.15</span>,
                              beta  = <span class="fl">0.2</span>,
                              Pi0   = <span class="fl">0.7</span>,
                              Pi1   = <span class="fl">0.7</span>,
                              delta = <span class="fl">0.15</span>,
                              equal = <span class="fl">FALSE</span>,
                              w     = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>))
<span class="kw">optimal</span>      <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha = <span class="fl">0.15</span>,
                              beta  = <span class="fl">0.2</span>,
                              Pi0   = <span class="fl">0.7</span>,
                              Pi1   = <span class="fl">0.7</span>,
                              delta = <span class="fl">0.15</span>,
                              equal = <span class="fl">FALSE</span>,
                              w     = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>))
<span class="kw">calgb</span>        <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha = <span class="fl">0.16</span>,
                              beta  = <span class="fl">0.2</span>,
                              Pi0   = <span class="fl">0.7</span>,
                              Pi1   = <span class="fl">0.7</span>,
                              delta = <span class="fl">0.15</span>,
                              equal = <span class="fl">FALSE</span>,
                              w     = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>))
<span class="co"># Example 2</span>
<span class="kw">minimax</span>      <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha = <span class="fl">0.15</span>,
                              beta  = <span class="fl">0.2</span>,
                              Pi0   = <span class="fl">0.7</span>,
                              Pi1   = <span class="fl">0.7</span>,
                              delta = <span class="fl">0.15</span>,
                              equal = <span class="fl">FALSE</span>,
                              ratio = <span class="fl">2</span>,
                              w     = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>))
<span class="kw">optimal</span>      <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha = <span class="fl">0.15</span>,
                              beta  = <span class="fl">0.2</span>,
                              Pi0   = <span class="fl">0.7</span>,
                              Pi1   = <span class="fl">0.7</span>,
                              delta = <span class="fl">0.15</span>,
                              equal = <span class="fl">FALSE</span>,
                              ratio = <span class="fl">2</span>,
                              w     = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>))
<span class="co"># Section 3.2</span>
<span class="kw">minimax</span>      <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha = <span class="fl">0.15</span>,
                              beta  = <span class="fl">0.2</span>,
                              Pi0   = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>),
                              Pi1   = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.85</span>),
                              delta = <span class="fl">0.15</span>,
                              equal = <span class="fl">FALSE</span>,
                              w     = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>))
<span class="kw">optimal</span>      <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha = <span class="fl">0.15</span>,
                              beta  = <span class="fl">0.2</span>,
                              Pi0   = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>),
                              Pi1   = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.85</span>),
                              delta = <span class="fl">0.15</span>,
                              equal = <span class="fl">FALSE</span>,
                              w     = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>))
</pre></div>
</div>
<div id="jung-and-sargent-2014" class="section level2">
<h2 class="hasAnchor">
<a href="#jung-and-sargent-2014" class="anchor"></a>3.2. Jung and Sargent (2014)</h2>
<p>Tables 2-5 from Jung and Sargent (2014) can be reproduced with</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="co"># Table 2</span>
<span class="kw">table_2</span>           <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">p0p1</span>, <span class="kw">p0p1</span>[, <span class="fl">2</span>]<span class="op">*</span>(<span class="fl">1</span> <span class="op">-</span> <span class="kw">p0p1</span>[, <span class="fl">1</span>])<span class="op">/</span>(<span class="kw">p0p1</span>[, <span class="fl">1</span>]<span class="op">*</span>(<span class="fl">1</span> <span class="op">-</span> <span class="kw">p0p1</span>[, <span class="fl">2</span>])),
        <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>), <span class="fl">11</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">table_2</span>) <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"py"</span>, <span class="st">"px"</span>, <span class="st">"theta"</span>, <span class="st">"Single-stage design: n"</span>,
                       <span class="st">"Single-stage design: alpha"</span>,
                       <span class="st">"Single-stage design: 1-beta"</span>,
                       <span class="st">"Minimax design: (n,n1)"</span>, <span class="st">"Minimax design: alpha"</span>,
                       <span class="st">"Minimax design: 1-beta"</span>, <span class="st">"Minimax design: EN"</span>,
                       <span class="st">"Optimal design: (n,n1)"</span>, <span class="st">"Optimal design: alpha"</span>,
                       <span class="st">"Optimal design: 1-beta"</span>, <span class="st">"Optimal design: EN"</span>)
<span class="kw">table_2</span>           <span class="op">&lt;-</span> <span class="kw">tibble</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw">table_2</span>)
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(alpha = <span class="fl">0.15</span>,
                                   beta  = <span class="fl">0.2</span>,
                                   type  = <span class="st">"fisher"</span>,
                                   delta = <span class="kw">table_2</span><span class="op">$</span><span class="kw">px</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_2</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi0   = <span class="kw">table_2</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi1   = <span class="kw">table_2</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   nCmax = <span class="fl">100L</span>)
  <span class="kw">table_2</span><span class="op">$</span><span class="kw">`Single-stage design: n`</span>[<span class="kw">i</span>]      <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>
  <span class="kw">table_2</span><span class="op">$</span><span class="kw">`Single-stage design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_2</span><span class="op">$</span><span class="kw">`Single-stage design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 2 single-stage design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>             <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">78</span>, <span class="fl">44</span>, <span class="fl">29</span>, <span class="fl">56</span>, <span class="fl">36</span>, <span class="fl">65</span>, <span class="fl">41</span>, <span class="fl">74</span>, <span class="fl">46</span>, <span class="fl">81</span>, <span class="fl">47</span>, <span class="fl">85</span>, <span class="fl">49</span>,
                           <span class="fl">86</span>, <span class="fl">54</span>, <span class="fl">87</span>, <span class="fl">54</span>, <span class="fl">87</span>, <span class="fl">54</span>, <span class="fl">86</span>, <span class="fl">49</span>, <span class="fl">85</span>, <span class="fl">47</span>, <span class="fl">81</span>, <span class="fl">46</span>, <span class="fl">74</span>,
                           <span class="fl">41</span>, <span class="fl">65</span>, <span class="fl">36</span>, <span class="fl">56</span>, <span class="fl">29</span>, <span class="fl">44</span>, <span class="fl">78</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.15</span>,
                                   beta    = <span class="fl">0.2</span>,
                                   type    = <span class="st">"fisher"</span>,
                                   delta   = <span class="kw">table_2</span><span class="op">$</span><span class="kw">px</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_2</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi0     = <span class="kw">table_2</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi1     = <span class="kw">table_2</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   equal   = <span class="fl">FALSE</span>,
                                   w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>),
                                   nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_2</span><span class="op">$</span><span class="kw">`Minimax design: (n,n1)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>,
                                                <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">")"</span>)
  <span class="kw">table_2</span><span class="op">$</span><span class="kw">`Minimax design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_2</span><span class="op">$</span><span class="kw">`Minimax design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_2</span><span class="op">$</span><span class="kw">`Minimax design: EN`</span>[<span class="kw">i</span>]     <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 2 minimax design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>             <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">81</span>, <span class="fl">44</span>, <span class="fl">29</span>, <span class="fl">58</span>, <span class="fl">37</span>, <span class="fl">69</span>, <span class="fl">42</span>, <span class="fl">79</span>, <span class="fl">49</span>, <span class="fl">84</span>, <span class="fl">50</span>, <span class="fl">95</span>, <span class="fl">52</span>,
                           <span class="fl">95</span>, <span class="fl">55</span>, <span class="fl">94</span>, <span class="fl">56</span>, <span class="fl">94</span>, <span class="fl">55</span>, <span class="fl">95</span>, <span class="fl">52</span>, <span class="fl">96</span>, <span class="fl">50</span>, <span class="fl">84</span>, <span class="fl">50</span>, <span class="fl">81</span>,
                           <span class="fl">43</span>, <span class="fl">69</span>, <span class="fl">38</span>, <span class="fl">59</span>, <span class="fl">30</span>, <span class="fl">46</span>, <span class="fl">83</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.15</span>,
                                   beta    = <span class="fl">0.2</span>,
                                   delta   = <span class="kw">table_2</span><span class="op">$</span><span class="kw">px</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_2</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi0     = <span class="kw">table_2</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi1     = <span class="kw">table_2</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   equal   = <span class="fl">FALSE</span>,
                                   w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>),
                                   nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_2</span><span class="op">$</span><span class="kw">`Optimal design: (n,n1)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>,
                                                <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">")"</span>)
  <span class="kw">table_2</span><span class="op">$</span><span class="kw">`Optimal design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_2</span><span class="op">$</span><span class="kw">`Optimal design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_2</span><span class="op">$</span><span class="kw">`Optimal design: EN`</span>[<span class="kw">i</span>]     <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 2 optimal design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="co"># Table 3</span>
<span class="kw">table_3</span>           <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">p0p1</span>, <span class="kw">p0p1</span>[, <span class="fl">2</span>]<span class="op">*</span>(<span class="fl">1</span> <span class="op">-</span> <span class="kw">p0p1</span>[, <span class="fl">1</span>])<span class="op">/</span>(<span class="kw">p0p1</span>[, <span class="fl">1</span>]<span class="op">*</span>(<span class="fl">1</span> <span class="op">-</span> <span class="kw">p0p1</span>[, <span class="fl">2</span>])),
        <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>), <span class="fl">11</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">table_3</span>) <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"p0"</span>, <span class="st">"p1"</span>, <span class="st">"theta"</span>, <span class="st">"Single-stage design: n"</span>,
                       <span class="st">"Single-stage design: alpha"</span>,
                       <span class="st">"Single-stage design: 1-beta"</span>,
                       <span class="st">"Minimax design: (n,n1)"</span>, <span class="st">"Minimax design: alpha"</span>,
                       <span class="st">"Minimax design: 1-beta"</span>, <span class="st">"Minimax design: EN"</span>,
                       <span class="st">"Optimal design: (n,n1)"</span>, <span class="st">"Optimal design: alpha"</span>,
                       <span class="st">"Optimal design: 1-beta"</span>, <span class="st">"Optimal design: EN"</span>)
<span class="kw">table_3</span>           <span class="op">&lt;-</span> <span class="kw">tibble</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw">table_3</span>)
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(alpha = <span class="fl">0.15</span>,
                                   beta  = <span class="fl">0.15</span>,
                                   type  = <span class="st">"fisher"</span>,
                                   delta = <span class="kw">table_3</span><span class="op">$</span><span class="kw">px</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_2</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi0   = <span class="kw">table_3</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi1   = <span class="kw">table_3</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   nCmax = <span class="fl">100L</span>)
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Single-stage design: n`</span>[<span class="kw">i</span>]      <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Single-stage design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Single-stage design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 3 single-stage design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>             <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">92</span>, <span class="fl">51</span>, <span class="fl">34</span>, <span class="fl">65</span>, <span class="fl">41</span>, <span class="fl">78</span>, <span class="fl">49</span>, <span class="fl">88</span>, <span class="fl">52</span>, <span class="fl">94</span>, <span class="fl">59</span>, <span class="fl">100</span>, <span class="fl">60</span>,
                           <span class="fl">106</span>, <span class="fl">61</span>, <span class="fl">107</span>, <span class="fl">61</span>, <span class="fl">107</span>, <span class="fl">61</span>, <span class="fl">106</span>, <span class="fl">60</span>, <span class="fl">100</span>, <span class="fl">59</span>, <span class="fl">94</span>, <span class="fl">52</span>,
                           <span class="fl">88</span>, <span class="fl">49</span>, <span class="fl">78</span>, <span class="fl">41</span>, <span class="fl">65</span>, <span class="fl">34</span>, <span class="fl">51</span>, <span class="fl">92</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.15</span>,
                                   beta    = <span class="fl">0.15</span>,
                                   type    = <span class="st">"fisher"</span>,
                                   delta   = <span class="kw">table_3</span><span class="op">$</span><span class="kw">px</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_3</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi0     = <span class="kw">table_3</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi1     = <span class="kw">table_3</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   equal   = <span class="fl">FALSE</span>,
                                   w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>),
                                   nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Minimax design: (n,n1)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>,
                                                <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">")"</span>)
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Minimax design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Minimax design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Minimax design: EN`</span>[<span class="kw">i</span>]     <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 3 minimax design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>             <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">94</span>, <span class="fl">52</span>, <span class="fl">34</span>, <span class="fl">68</span>, <span class="fl">42</span>, <span class="fl">82</span>, <span class="fl">51</span>, <span class="fl">93</span>, <span class="fl">56</span>, <span class="fl">102</span>, <span class="fl">62</span>, <span class="fl">107</span>, <span class="fl">65</span>,
                           <span class="fl">114</span>, <span class="fl">65</span>, <span class="fl">115</span>, <span class="fl">66</span>, <span class="fl">115</span>, <span class="fl">65</span>, <span class="fl">114</span>, <span class="fl">65</span>, <span class="fl">107</span>, <span class="fl">62</span>, <span class="fl">102</span>, <span class="fl">56</span>,
                           <span class="fl">93</span>, <span class="fl">52</span>, <span class="fl">84</span>, <span class="fl">43</span>, <span class="fl">69</span>, <span class="fl">35</span>, <span class="fl">53</span>, <span class="fl">98</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.15</span>,
                                   beta    = <span class="fl">0.15</span>,
                                   delta   = <span class="kw">table_3</span><span class="op">$</span><span class="kw">px</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_3</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi0     = <span class="kw">table_3</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi1     = <span class="kw">table_3</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   equal   = <span class="fl">FALSE</span>,
                                   w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>),
                                   nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Optimal design: (n,n1)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>,
                                                <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">")"</span>)
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Optimal design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Optimal design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Optimal design: EN`</span>[<span class="kw">i</span>]     <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 3 optimal design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="co"># Table 4</span>
<span class="kw">table_4</span>           <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">p0p1</span>, <span class="kw">p0p1</span>[, <span class="fl">2</span>]<span class="op">*</span>(<span class="fl">1</span> <span class="op">-</span> <span class="kw">p0p1</span>[, <span class="fl">1</span>])<span class="op">/</span>(<span class="kw">p0p1</span>[, <span class="fl">1</span>]<span class="op">*</span>(<span class="fl">1</span> <span class="op">-</span> <span class="kw">p0p1</span>[, <span class="fl">2</span>])),
        <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>), <span class="fl">11</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">table_4</span>) <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"p0"</span>, <span class="st">"p1"</span>, <span class="st">"theta"</span>, <span class="st">"Single-stage design: n"</span>,
                       <span class="st">"Single-stage design: alpha"</span>,
                       <span class="st">"Single-stage design: 1-beta"</span>,
                       <span class="st">"Minimax design: (n,n1)"</span>, <span class="st">"Minimax design: alpha"</span>,
                       <span class="st">"Minimax design: 1-beta"</span>, <span class="st">"Minimax design: EN"</span>,
                       <span class="st">"Optimal design: (n,n1)"</span>, <span class="st">"Optimal design: alpha"</span>,
                       <span class="st">"Optimal design: 1-beta"</span>, <span class="st">"Optimal design: EN"</span>)
<span class="kw">table_4</span>           <span class="op">&lt;-</span> <span class="kw">tibble</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw">table_4</span>)
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(alpha = <span class="fl">0.2</span>,
                                   beta  = <span class="fl">0.2</span>,
                                   type  = <span class="st">"fisher"</span>,
                                   delta = <span class="kw">table_4</span><span class="op">$</span><span class="kw">px</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_4</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi0   = <span class="kw">table_4</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi1   = <span class="kw">table_4</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   nCmax = <span class="fl">100L</span>)
  <span class="kw">table_4</span><span class="op">$</span><span class="kw">`Single-stage design: n`</span>[<span class="kw">i</span>]      <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>
  <span class="kw">table_4</span><span class="op">$</span><span class="kw">`Single-stage design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_4</span><span class="op">$</span><span class="kw">`Single-stage design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 4 single-stage design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>             <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">65</span>, <span class="fl">38</span>, <span class="fl">25</span>, <span class="fl">47</span>, <span class="fl">30</span>, <span class="fl">54</span>, <span class="fl">34</span>, <span class="fl">62</span>, <span class="fl">39</span>, <span class="fl">67</span>, <span class="fl">40</span>, <span class="fl">68</span>, <span class="fl">41</span>,
                           <span class="fl">69</span>, <span class="fl">42</span>, <span class="fl">70</span>, <span class="fl">42</span>, <span class="fl">70</span>, <span class="fl">42</span>, <span class="fl">69</span>, <span class="fl">41</span>, <span class="fl">68</span>, <span class="fl">41</span>, <span class="fl">67</span>, <span class="fl">39</span>, <span class="fl">62</span>,
                           <span class="fl">34</span>, <span class="fl">54</span>, <span class="fl">30</span>, <span class="fl">47</span>, <span class="fl">25</span>, <span class="fl">38</span>, <span class="fl">65</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.2</span>,
                                   beta    = <span class="fl">0.2</span>,
                                   type    = <span class="st">"fisher"</span>,
                                   delta   = <span class="kw">table_4</span><span class="op">$</span><span class="kw">px</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_4</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi0     = <span class="kw">table_4</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi1     = <span class="kw">table_4</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   equal   = <span class="fl">FALSE</span>,
                                   w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>),
                                   nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_4</span><span class="op">$</span><span class="kw">`Minimax design: (n,n1)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>,
                                                <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">")"</span>)
  <span class="kw">table_4</span><span class="op">$</span><span class="kw">`Minimax design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_4</span><span class="op">$</span><span class="kw">`Minimax design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_4</span><span class="op">$</span><span class="kw">`Minimax design: EN`</span>[<span class="kw">i</span>]     <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 4 minimax design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>             <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">68</span>, <span class="fl">38</span>, <span class="fl">25</span>, <span class="fl">47</span>, <span class="fl">31</span>, <span class="fl">60</span>, <span class="fl">35</span>, <span class="fl">65</span>, <span class="fl">40</span>, <span class="fl">73</span>, <span class="fl">45</span>, <span class="fl">75</span>, <span class="fl">45</span>,
                           <span class="fl">76</span>, <span class="fl">46</span>, <span class="fl">77</span>, <span class="fl">45</span>, <span class="fl">77</span>, <span class="fl">46</span>, <span class="fl">76</span>, <span class="fl">45</span>, <span class="fl">77</span>, <span class="fl">45</span>, <span class="fl">73</span>, <span class="fl">40</span>, <span class="fl">65</span>,
                           <span class="fl">36</span>, <span class="fl">60</span>, <span class="fl">33</span>, <span class="fl">48</span>, <span class="fl">26</span>, <span class="fl">40</span>, <span class="fl">70</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.2</span>,
                                   beta    = <span class="fl">0.2</span>,
                                   delta   = <span class="kw">table_4</span><span class="op">$</span><span class="kw">px</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_4</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi0     = <span class="kw">table_4</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi1     = <span class="kw">table_4</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   equal   = <span class="fl">FALSE</span>,
                                   w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>),
                                   nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_4</span><span class="op">$</span><span class="kw">`Optimal design: (n,n1)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>,
                                                <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">")"</span>)
  <span class="kw">table_4</span><span class="op">$</span><span class="kw">`Optimal design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_4</span><span class="op">$</span><span class="kw">`Optimal design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_4</span><span class="op">$</span><span class="kw">`Optimal design: EN`</span>[<span class="kw">i</span>]     <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 4 optimal design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="co"># Table 5</span>
<span class="kw">table_5</span>           <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">p0p1</span>, <span class="kw">p0p1</span>[, <span class="fl">2</span>]<span class="op">*</span>(<span class="fl">1</span> <span class="op">-</span> <span class="kw">p0p1</span>[, <span class="fl">1</span>])<span class="op">/</span>(<span class="kw">p0p1</span>[, <span class="fl">1</span>]<span class="op">*</span>(<span class="fl">1</span> <span class="op">-</span> <span class="kw">p0p1</span>[, <span class="fl">2</span>])),
        <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>), <span class="fl">11</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">table_5</span>) <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"p0"</span>, <span class="st">"p1"</span>, <span class="st">"theta"</span>, <span class="st">"Single-stage design: n"</span>,
                       <span class="st">"Single-stage design: alpha"</span>,
                       <span class="st">"Single-stage design: 1-beta"</span>,
                       <span class="st">"Minimax design: (n,n1)"</span>, <span class="st">"Minimax design: alpha"</span>,
                       <span class="st">"Minimax design: 1-beta"</span>, <span class="st">"Minimax design: EN"</span>,
                       <span class="st">"Optimal design: (n,n1)"</span>, <span class="st">"Optimal design: alpha"</span>,
                       <span class="st">"Optimal design: 1-beta"</span>, <span class="st">"Optimal design: EN"</span>)
<span class="kw">table_5</span>           <span class="op">&lt;-</span> <span class="kw">tibble</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw">table_5</span>)
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(alpha = <span class="fl">0.2</span>,
                                   beta  = <span class="fl">0.15</span>,
                                   type  = <span class="st">"fisher"</span>,
                                   delta = <span class="kw">table_5</span><span class="op">$</span><span class="kw">px</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_4</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi0   = <span class="kw">table_5</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi1   = <span class="kw">table_5</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   nCmax = <span class="fl">100L</span>)
  <span class="kw">table_5</span><span class="op">$</span><span class="kw">`Single-stage design: n`</span>[<span class="kw">i</span>]      <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>
  <span class="kw">table_5</span><span class="op">$</span><span class="kw">`Single-stage design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_5</span><span class="op">$</span><span class="kw">`Single-stage design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 5 single-stage design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>             <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">78</span>, <span class="fl">44</span>, <span class="fl">30</span>, <span class="fl">56</span>, <span class="fl">35</span>, <span class="fl">65</span>, <span class="fl">42</span>, <span class="fl">74</span>, <span class="fl">45</span>, <span class="fl">78</span>, <span class="fl">46</span>, <span class="fl">87</span>, <span class="fl">50</span>,
                           <span class="fl">89</span>, <span class="fl">53</span>, <span class="fl">89</span>, <span class="fl">53</span>, <span class="fl">89</span>, <span class="fl">53</span>, <span class="fl">89</span>, <span class="fl">50</span>, <span class="fl">87</span>, <span class="fl">46</span>, <span class="fl">78</span>, <span class="fl">45</span>, <span class="fl">74</span>,
                           <span class="fl">42</span>, <span class="fl">65</span>, <span class="fl">35</span>, <span class="fl">56</span>, <span class="fl">30</span>, <span class="fl">44</span>, <span class="fl">78</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.2</span>,
                                   beta    = <span class="fl">0.15</span>,
                                   type    = <span class="st">"fisher"</span>,
                                   delta   = <span class="kw">table_5</span><span class="op">$</span><span class="kw">px</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_4</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi0     = <span class="kw">table_5</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi1     = <span class="kw">table_5</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   equal   = <span class="fl">FALSE</span>,
                                   w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>),
                                   nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_5</span><span class="op">$</span><span class="kw">`Minimax design: (n,n1)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>,
                                                <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">")"</span>)
  <span class="kw">table_5</span><span class="op">$</span><span class="kw">`Minimax design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_5</span><span class="op">$</span><span class="kw">`Minimax design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_5</span><span class="op">$</span><span class="kw">`Minimax design: EN`</span>[<span class="kw">i</span>]     <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 5 minimax design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>             <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">81</span>, <span class="fl">44</span>, <span class="fl">30</span>, <span class="fl">59</span>, <span class="fl">37</span>, <span class="fl">69</span>, <span class="fl">43</span>, <span class="fl">80</span>, <span class="fl">48</span>, <span class="fl">84</span>, <span class="fl">50</span>, <span class="fl">92</span>, <span class="fl">52</span>,
                           <span class="fl">93</span>, <span class="fl">55</span>, <span class="fl">96</span>, <span class="fl">57</span>, <span class="fl">96</span>, <span class="fl">55</span>, <span class="fl">92</span>, <span class="fl">52</span>, <span class="fl">92</span>, <span class="fl">50</span>, <span class="fl">85</span>, <span class="fl">48</span>, <span class="fl">82</span>,
                           <span class="fl">44</span>, <span class="fl">69</span>, <span class="fl">37</span>, <span class="fl">59</span>, <span class="fl">31</span>, <span class="fl">46</span>, <span class="fl">83</span>)))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha   = <span class="fl">0.2</span>,
                                   beta    = <span class="fl">0.15</span>,
                                   delta   = <span class="kw">table_5</span><span class="op">$</span><span class="kw">px</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_4</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi0     = <span class="kw">table_5</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   Pi1     = <span class="kw">table_5</span><span class="op">$</span><span class="kw">py</span>[<span class="kw">i</span>],
                                   equal   = <span class="fl">FALSE</span>,
                                   w       = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>),
                                   nCmax   = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_5</span><span class="op">$</span><span class="kw">`Optimal design: (n,n1)`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>), <span class="st">","</span>,
                                                <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>], <span class="st">")"</span>)
  <span class="kw">table_5</span><span class="op">$</span><span class="kw">`Optimal design: alpha`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_5</span><span class="op">$</span><span class="kw">`Optimal design: 1-beta`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="kw">table_5</span><span class="op">$</span><span class="kw">`Optimal design: EN`</span>[<span class="kw">i</span>]     <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]<span class="op">/</span><span class="fl">2</span>
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 5 optimal design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
</pre></div>
</div>
<div id="litwin-et-al-2017" class="section level2">
<h2 class="hasAnchor">
<a href="#litwin-et-al-2017" class="anchor"></a>3.3. Litwin <em>et al</em> (2017)</h2>
<p>Currently, <strong>ph2rand</strong> identifies designs of the type from Litwin <em>et al</em> (2017) in a different way to Litwin <em>et al</em> (2017), and therefore results from this article cannot at present by directly reproduced.</p>
</div>
<div id="shan-et-al-2013" class="section level2">
<h2 class="hasAnchor">
<a href="#shan-et-al-2013" class="anchor"></a>3.4. Shan <em>et al</em> (2013)</h2>
<p>Tables 2-3 from Shan <em>et al</em> (2013) can be reproduced with</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">fact</span>              <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>), each = <span class="fl">4</span>)
<span class="kw">p0p1</span>              <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">fact</span>, <span class="kw">fact</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.15</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>), <span class="fl">5</span>))
<span class="co"># Table 2</span>
<span class="kw">table_2</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">p0p1</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>), <span class="fl">4</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">table_2</span>) <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"p0"</span>, <span class="st">"p1"</span>, <span class="st">"Method"</span>, <span class="st">"Total sample size"</span>,
                       <span class="st">"Type I error"</span>, <span class="st">"Power"</span>)
<span class="kw">table_2</span>           <span class="op">&lt;-</span> <span class="kw">tibble</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw">table_2</span>)
<span class="kw">table_2</span><span class="op">$</span><span class="kw">Method</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"barnard"</span>, <span class="st">"fisher"</span>), <span class="fl">10</span>)
<span class="kw">nCmax</span>             <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">90</span>, <span class="fl">112</span>, <span class="fl">58</span>, <span class="fl">72</span>, <span class="fl">128</span>, <span class="fl">148</span>, <span class="fl">78</span>, <span class="fl">92</span>, <span class="fl">154</span>, <span class="fl">170</span>, <span class="fl">86</span>, <span class="fl">106</span>,
                           <span class="fl">156</span>, <span class="fl">174</span>, <span class="fl">96</span>, <span class="fl">108</span>, <span class="fl">156</span>, <span class="fl">172</span>, <span class="fl">86</span>, <span class="fl">106</span>)<span class="op">/</span><span class="fl">2</span>))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(alpha = <span class="fl">0.15</span>,
                                   beta  = <span class="fl">0.2</span>,
                                   type  = <span class="kw">table_2</span><span class="op">$</span><span class="kw">Method</span>[<span class="kw">i</span>],
                                   delta = <span class="kw">table_2</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_2</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   Pi0   = <span class="kw">table_2</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   Pi1   = <span class="kw">table_2</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   nCmax = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_2</span><span class="op">$</span><span class="kw">`Total sample size`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span> <span class="op">+</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">nE</span>
  <span class="kw">table_2</span><span class="op">$</span><span class="kw">`Type I error`</span>[<span class="kw">i</span>]       <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">1</span>]
  <span class="kw">table_2</span><span class="op">$</span><span class="kw">`Power`</span>[<span class="kw">i</span>]              <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`P(pi)`</span>[<span class="fl">2</span>]
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 2 single-stage design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="co"># Table 3</span>
<span class="kw">table_3</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">p0p1</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>), <span class="fl">13</span>))
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="kw">table_3</span>) <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"p0"</span>, <span class="st">"p1"</span>, <span class="st">"Method"</span>, <span class="st">"Minimax design: n1"</span>,
                       <span class="st">"Minimax design: n2"</span>, <span class="st">"Minimax design: N"</span>,
                       <span class="st">"Minimax design: ESS"</span>, <span class="st">"Optimal design: n1"</span>,
                       <span class="st">"Optimal design: n2"</span>, <span class="st">"Optimal design: N"</span>,
                       <span class="st">"Optimal design: ESS"</span>, <span class="st">"Constrained design: n1"</span>,
                       <span class="st">"Constrained design: n2"</span>, <span class="st">"Constrained design: N"</span>,
                       <span class="st">"Constrained design: ESS"</span>)
<span class="kw">table_3</span>           <span class="op">&lt;-</span> <span class="kw">tibble</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw">table_3</span>)
<span class="kw">table_3</span><span class="op">$</span><span class="kw">Method</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"barnard"</span>, <span class="st">"fisher"</span>), <span class="fl">10</span>)
<span class="kw">nCmax</span>             <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">72</span>, <span class="fl">112</span>, <span class="fl">42</span>, <span class="fl">72</span>, <span class="fl">94</span>, <span class="fl">148</span>, <span class="fl">60</span>, <span class="fl">92</span>, <span class="fl">112</span>, <span class="fl">170</span>, <span class="fl">72</span>, <span class="fl">98</span>,
                           <span class="fl">120</span>, <span class="fl">174</span>, <span class="fl">76</span>, <span class="fl">108</span>, <span class="fl">122</span>, <span class="fl">172</span>, <span class="fl">76</span>, <span class="fl">98</span>)<span class="op">/</span><span class="fl">2</span>))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha = <span class="fl">0.15</span>,
                                   beta  = <span class="fl">0.2</span>,
                                   type  = <span class="kw">table_3</span><span class="op">$</span><span class="kw">Method</span>[<span class="kw">i</span>],
                                   delta = <span class="kw">table_3</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_3</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   Pi0   = <span class="kw">table_3</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   Pi1   = <span class="kw">table_3</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   equal = <span class="fl">FALSE</span>,
                                   w     = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e-6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>),
                                   nCmax = <span class="kw">nCmax</span>[<span class="kw">i</span>], summary = <span class="fl">TRUE</span>)
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Minimax design: n1`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">1</span>]
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Minimax design: n2`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>[<span class="fl">2</span>]
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Minimax design: N`</span>[<span class="kw">i</span>]   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nC</span>) <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">nE</span>)
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Minimax design: ESS`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 3 minimax design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>             <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">118</span>, <span class="fl">116</span>, <span class="fl">108</span>, <span class="fl">74</span>, <span class="fl">132</span>, <span class="fl">158</span>, <span class="fl">94</span>, <span class="fl">98</span>, <span class="fl">140</span>, <span class="fl">190</span>, <span class="fl">140</span>,
                           <span class="fl">104</span>, <span class="fl">140</span>, <span class="fl">188</span>, <span class="fl">132</span>, <span class="fl">112</span>, <span class="fl">140</span>, <span class="fl">190</span>, <span class="fl">140</span>, <span class="fl">104</span>)<span class="op">/</span><span class="fl">2</span>))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha = <span class="fl">0.15</span>,
                                   beta  = <span class="fl">0.2</span>,
                                   type  = <span class="kw">table_3</span><span class="op">$</span><span class="kw">Method</span>[<span class="kw">i</span>],
                                   delta = <span class="kw">table_3</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_3</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   Pi0   = <span class="kw">table_3</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   Pi1   = <span class="kw">table_3</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   equal = <span class="fl">FALSE</span>,
                                   w     = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>),
                                   nCmax = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Optimal design: n1`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC1</span>
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Optimal design: n2`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC2</span>
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Optimal design: N`</span>[<span class="kw">i</span>]   <span class="op">&lt;-</span>
    <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC1</span> <span class="op">+</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">nC2</span> <span class="op">+</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">nE1</span> <span class="op">+</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">nE2</span>
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Optimal design: ESS`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">des_i</span><span class="op">$</span><span class="kw">opchar</span><span class="op">$</span><span class="kw">`ESS(pi)`</span>[<span class="fl">1</span>]
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 3 optimal design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
<span class="kw">nCmax</span>             <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fl">1.1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">84</span>, <span class="fl">52</span>, <span class="fl">126</span>, <span class="fl">72</span>, <span class="fl">140</span>, <span class="fl">80</span>, <span class="fl">140</span>, <span class="fl">82</span>, <span class="fl">140</span>, <span class="fl">78</span>)<span class="op">/</span><span class="fl">2</span>))
<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(<span class="kw">p0p1</span>), <span class="fl">2</span>)) {
  <span class="kw">des_i</span>           <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(alpha = <span class="fl">0.15</span>,
                                   beta  = <span class="fl">0.2</span>,
                                   type  = <span class="kw">table_3</span><span class="op">$</span><span class="kw">Method</span>[<span class="kw">i</span>],
                                   delta = <span class="kw">table_3</span><span class="op">$</span><span class="kw">p1</span>[<span class="kw">i</span>] <span class="op">-</span> <span class="kw">table_3</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   Pi0   = <span class="kw">table_3</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   Pi1   = <span class="kw">table_3</span><span class="op">$</span><span class="kw">p0</span>[<span class="kw">i</span>],
                                   equal = <span class="fl">FALSE</span>,
                                   w     = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>),
                                   nCmax = <span class="kw">nCmax</span>[<span class="kw">i</span>])
  <span class="kw">n1_ge_n2_i</span>                           <span class="op">&lt;-</span> <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw">des_i</span><span class="op">$</span><span class="kw">feasible</span>,
                                                        <span class="kw">n1C</span> <span class="op">&gt;=</span> <span class="kw">n2C</span>)
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Constrained design: n1`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">n1_gs_n2_i</span><span class="op">$</span><span class="kw">n1C</span>[<span class="fl">1</span>]
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Constrained design: n2`</span>[<span class="kw">i</span>]  <span class="op">&lt;-</span> <span class="kw">n1_gs_n2_i</span><span class="op">$</span><span class="kw">n2C</span>[<span class="fl">1</span>]
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Constrained design: N`</span>[<span class="kw">i</span>]   <span class="op">&lt;-</span> <span class="kw">n1_gs_n2_i</span><span class="op">$</span><span class="kw">`max N`</span>
  <span class="kw">table_3</span><span class="op">$</span><span class="kw">`Constrained design: ESS`</span>[<span class="kw">i</span>] <span class="op">&lt;-</span> <span class="kw">n1_gs_n2_i</span><span class="op">$</span><span class="kw">`ESS(piO,piO)`</span>[<span class="fl">1</span>]
  <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"..Table 3 constrained design "</span>, <span class="kw">i</span>, <span class="st">" completed.."</span>)
}
</pre></div>
<p>Note that Shan <em>et al</em> (2013) does not make it clear how optimised two-stage designs are identified (i.e., what restrictions are placed on the search space). It appears almost no restrictions were placed (see the minimax designs, which often have a single patient in stage 2). <strong>ph2rand</strong> enforces restrictions that the optimal two-stage design must be a true two-stage design (i.e., the result at the end of stage 2 cannot be certain having continued to stage 2). Consequently, this leads to several differences when attempting to reproduce Table 3. Furthermore, the ‘Sequential’ design of Table 3 is not currently supported by <strong>ph2rand</strong>, so these rows are omitted.</p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>4. References</h1>
<p>Jung SH (2008) Randomized phase II trials with a prospective control. <em>Stat Med</em> 27(4):568–83. DOI: <a href="https://doi.org/10.1002/sim.2961">10.1002/sim.2961</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/17573688">17573688</a>.</p>
<p>Jung SH, Sargent DJ (2014) Randomized phase II clinical trials. <em>J Biopharm Stat</em> 24(4):802–16. DOI: <a href="https://doi.org/10.1080/10543406.2014.901343">10.1080/10543406.2014.901343</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/24697589">24697589</a>.</p>
<p>Litwin S, Basickes S, Ross EA (2017) Two-sample binary phase 2 trials with low type I error and low sample size. <em>Stat Med</em> 36(9):1383–94. DOI: <a href="http://doi.org/10.1002/sim.7226">10.1002/sim.7226</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/28118686">28118686</a>.</p>
<p>Shan G, Ma C, Hutson AD, Wilding GE (2013) Randomized two-stage phase II clinical trial designs based on Barnard’s exact test. <em>J Biopharm Stat</em> 23(5):1081–90. DOI: <a href="https://doi.org/10.1080/10543406.2013.813525">10.1080/10543406.2013.813525</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/23957517">23957517</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Michael Grayling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
