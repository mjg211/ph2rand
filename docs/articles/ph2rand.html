<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ph2rand: Design of randomized comparative phase II oncology trials with a Bernoulli distributed primary outcome • ph2rand</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ph2rand: Design of randomized comparative phase II oncology trials with a Bernoulli distributed primary outcome">
<meta property="og:description" content="ph2rand">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ph2rand</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ph2rand.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mjg211/ph2rand/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ph2rand_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ph2rand: Design of randomized comparative phase II oncology trials with a Bernoulli distributed primary outcome</h1>
                        <h4 class="author">Michael J Grayling (<a href="mailto:michael.grayling@newcastle.ac.uk" class="email">michael.grayling@newcastle.ac.uk</a>)</h4>
            
            <h4 class="date">2020-09-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mjg211/ph2rand/blob/master/vignettes/ph2rand.Rmd"><code>vignettes/ph2rand.Rmd</code></a></small>
      <div class="hidden name"><code>ph2rand.Rmd</code></div>

    </div>

    
    
<p><strong>ph2rand</strong> provides functions to assist with the design of randomized comparative phase II oncology trials that assume their primary outcome variable is Bernoulli distributed. Specifically, support is provided to (a) perform a sample size calculation when using one of several published designs, (b) evaluate the operating characteristics of a given design (both analytically and via simulation), and (c) produce informative plots.</p>
<p>This vignette will proceed by detailing the type of trial designs <strong>ph2rand</strong> currently supports. Each of the available functions will then be described, before several examples and useful further information will be provided.</p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>1. Introduction</h1>
<p>Whilst almost all phase II oncology trials once utilised single-arm non-randomised designs, a large proportion now use randomised comparative designs. The reasons for this change in design are numerous, and are described at length in Grayling <em>et al</em> (2019). For the purposes of this vignette, the important consideration is that with the increased use of randomised comparative designs in phase II, software for determining such designs increases in value. It is for this reason that this package, <strong>ph2rand</strong>, has been developed. Its goal is to eventually support design determination when using the vast majority of published methods for randomised comparative oncology trials. At present, the focus is on the most commonly used class of design: those for two-arm trials with a single primary outcome variable that is assumed to be Bernoulli distributed.</p>
</div>
<div id="randomized-comparative-phase-ii-oncology-trials" class="section level1">
<h1 class="hasAnchor">
<a href="#randomized-comparative-phase-ii-oncology-trials" class="anchor"></a>2. Randomized comparative phase II oncology trials</h1>
<div id="design-setting" class="section level2">
<h2 class="hasAnchor">
<a href="#design-setting" class="anchor"></a>2.1. Design setting</h2>
<p>At present, all of the methods supported by <strong>ph2rand</strong> can be described within a single design framework. Each assumes that a single experimental treatment regimen will be compared to a single concurrent control arm (which would typically be expected to be the current standard-of-care treatment option), through a trial with at most <span class="math inline">\(J\in\mathbb{N}^+\)</span> stages (i.e., in what follows we will simultaneously treat one-stage designs and designs that include interim analyses).</p>
<p>Furthermore, each supposes that the treatment’s anti-tumour activity will be formally compared through a single Bernoulli distributed primary outcome variable (e.g., tumour response or the disease control rate). Precisely, they assume that outcomes <span class="math inline">\(y_{ijk}\)</span> are accrued from patients <span class="math inline">\(i\in\{1,\dots,n_{jk}\}\)</span>, in stage <span class="math inline">\(j\in\{1,\dots,J\}\)</span>, in arm <span class="math inline">\(k\in\{C,E\}\)</span>, with <span class="math inline">\(Y_{ijk} \sim Bern(\pi_k)\)</span> (i.e., we use <span class="math inline">\(Y_{ijk}\)</span> to indicate the random value of <span class="math inline">\(y_{ijk}\)</span>). Here, arm <span class="math inline">\(k=C\)</span> corresponds to the control arm and arm <span class="math inline">\(k=E\)</span> to the experimental arm, and together the indices <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> define a particular patient. Thus, <span class="math inline">\(\pi_k\in[0,1]\)</span> is the probability of success (or response, if you prefer) for patient <span class="math inline">\(ij\)</span> when they are assigned to arm <span class="math inline">\(k\)</span>. For brevity in what follows, we set <span class="math inline">\(\boldsymbol{\pi}=(\pi_C,\pi_E)^\top\in[0,1]^2\)</span>, and from here we will refer to the <span class="math inline">\(\pi_k\)</span> as response rates. Similarly, we set <span class="math inline">\(\boldsymbol{n}_k=(n_{1k},\dots,n_{Jk})\)</span> for <span class="math inline">\(k\in\{C,E\}\)</span>. Note that at this stage we explicitly allow for the range of <span class="math inline">\(i\)</span> to depend on both <span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span>, which will be discussed again in Section 3.</p>
<p>With the above, the designs supported by <strong>ph2rand</strong> test the following null hypothesis</p>
<p><span class="math display">\[ H_0 : \pi_C \le \pi_E. \]</span> Then, given a trial design of any kind returned by <strong>ph2rand</strong>, which we denote in generality at this point by <span class="math inline">\(\mathcal{D}\)</span>, we will signify the power function as follows</p>
<p><span class="math display">\[ P(\boldsymbol{\pi}) = \mathbb{P}(\text{Reject }H_0 \mid \boldsymbol{\pi},\mathcal{D}). \]</span> Using the above definition, each of the design functions in <strong>ph2rand</strong> aims to return an optimised design (as defined below), which ensures that the type-I error-rate is controlled to a specified level <span class="math inline">\(\alpha \in (0,1)\)</span> over a given set <span class="math inline">\(\Pi_0\subseteq [0,1]\)</span>. Formally, they look to identify a design with</p>
<p><span class="math display">\[ \max_{\pi\in\Pi_0} P\{(\pi,\pi)^\top\} \le \alpha. \]</span> Thus, <strong>ph2rand</strong> implicitly assumes a monotonicity property on the power function such that the type-I error-rate is maximised along the boundary of the null hypothesis where <span class="math inline">\(\pi_C=\pi_E\)</span>. Note that <span class="math inline">\(\Pi_0\)</span> can be anything from a single point (e.g., <span class="math inline">\(0.1\)</span>), which would logically correspond to the anticipated response rate in the control arm, through to the entire line <span class="math inline">\([0,1]\)</span>. The implications of different choices for <span class="math inline">\(\Pi_0\)</span> are discussed in Section 3.</p>
<p>Furthermore, <strong>ph2rand</strong> supports powering trials under the following flexible framework. First, a clinically relevant difference in response rates (or treatment effect) <span class="math inline">\(\delta \in (0,1]\)</span> is specified. Then, a set <span class="math inline">\(\Pi_1 \subseteq [0,1-\delta]\)</span> is nominated, such that design determination should ensure that</p>
<p><span class="math display">\[ \min_{\pi\in\Pi_1} P\{(\pi,\pi+\delta)^\top\} \ge 1 - \beta, \]</span> where <span class="math inline">\(\beta\in(0,1)\)</span> can be viewed as the type-II error-rate, and we refer to this scenario later as the alternative hypothesis.</p>
<p>The above outlines the hypothesis and error-rates each of the designs supported by <strong>ph2rand</strong> aims to control. To appreciate the differences between the way the designs work later, it is useful now to consider a general framework for decision making.</p>
<p>First, each design framework specifies particular test statistics <span class="math inline">\(\boldsymbol{t}_j\)</span> that would be computed after stage <span class="math inline">\(j\)</span> to base its decisions on. We denote that the random values of these test statistics by <span class="math inline">\(\boldsymbol{T}_j\)</span>. In all instances <span class="math inline">\(\boldsymbol{t}_j\)</span> will be dependent on (at most) the chosen design (e.g., factors such as the sample size in each arm in each stage) and the number of responses seen in each arm in each stage. For computational purposes, it will be useful to categorise what we denote by <span class="math inline">\(\mathscr{T}_j\)</span>, the support of <span class="math inline">\(\boldsymbol{T}_j\)</span> (i.e., the space of possible values such that <span class="math inline">\(\boldsymbol{t}_j\in\mathscr{T}_j\)</span>). Note that it will always be the case that more positive values for the elements of <span class="math inline">\(\boldsymbol{t}_j\)</span> indicate increased patient benefit on the experimental treatment.</p>
<p>In addition, each of the design frameworks specifies particular rejection, non-rejection, and continuation regions. Each of these can be viewed as a sub-space such that if the chosen test statistics belongs to that space, then a given associated decision will be made. As above, these sets will only ever be dependent on the chosen design and the number of responses seen in each arm in each stage. We define them as <span class="math inline">\(\mathscr{R}_j\)</span>, <span class="math inline">\(\mathscr{N}_j\)</span>, and <span class="math inline">\(\mathscr{C}_j\)</span>. Here, <span class="math inline">\(\mathscr{R}\)</span>, <span class="math inline">\(\mathscr{N}\)</span>, and <span class="math inline">\(\mathscr{C}\)</span> are chosen to indicate rejection, non-rejection, and continuation respectively. As will be seen later, this framework can readily handle any value of <span class="math inline">\(J\)</span>, as we can always ensure a trial terminates after at most <span class="math inline">\(J\)</span> stages by ensuring <span class="math inline">\(\mathscr{R}_J\cup\mathscr{N}_J = \mathscr{T}_J\)</span>. More generally, we can ensure a decision on how to proceed is always clear by making sure <span class="math inline">\(\mathscr{C}_j = \mathscr{T}_j\backslash\{\mathscr{R}_j \cup \mathscr{N}_j\}\)</span>, thus in what follows we do not explicitly state the forms for <span class="math inline">\(\mathscr{C}_j\)</span>. All designs supported by <strong>ph2rand</strong> ensure that these conditions are met.</p>
<p>Ultimately, with the above, the following algorithm describes how each of the designs work</p>
<ol style="list-style-type: decimal">
<li>Set <span class="math inline">\(j=1\)</span>.</li>
<li>Recruit <span class="math inline">\(n_{jk}\)</span> patients to arms <span class="math inline">\(k\in\{C,E\}\)</span> and gather the associated outcomes <span class="math inline">\(y_{ijk}\)</span> for <span class="math inline">\(i\in\{1,\dots,n_{jk}\}\)</span>.</li>
<li>Compute <span class="math inline">\(\boldsymbol{t}_j\)</span> and use the following decision rules
<ul>
<li>If <span class="math inline">\(\boldsymbol{t}_j \in \mathscr{C}_j\)</span>, set <span class="math inline">\(j=j+1\)</span> and return to step 2.</li>
<li>If <span class="math inline">\(\boldsymbol{t}_j \in \mathscr{R}_j\)</span>, terminate the trial and reject <span class="math inline">\(H_0\)</span>.</li>
<li>If <span class="math inline">\(\boldsymbol{t}_j \in \mathscr{N}_j\)</span>, terminate the trial and do not reject <span class="math inline">\(H_0\)</span>.</li>
</ul>
</li>
</ol>
<p>The above completes the categorisation of the core principles of the designs supported by <strong>ph2rand</strong>. In practice, a large number of potential designs will meet the type-I and type-II error-rate criteria, and thus a condition is needed for choosing the best (i.e., optimal) design amongst these. Before we outline the optimality criteria supported by <strong>ph2rand</strong>, though, we describe the various statistical operating characteristics that it can return.</p>
</div>
<div id="operating-characteristics" class="section level2">
<h2 class="hasAnchor">
<a href="#operating-characteristics" class="anchor"></a>2.2. Operating characteristics</h2>
<p>For one-stage designs, <span class="math inline">\(P(\boldsymbol{\pi})\)</span> will likely be the only random quantity of interest. For designs with more than one stage, though, there are several additional random variables that should be considered. Firstly, it will generally be of both interest and great use to evaluate the probability that the trial stops at the end of each permitted stage, with sub-categorisation according to the decision on whether or not <span class="math inline">\(H_0\)</span> should be rejected. We define these quantities for <span class="math inline">\(j\in\{1,\dots,J\}\)</span> as follows</p>
<p><span class="math display">\[\begin{align}
  E_j(\boldsymbol{\pi}) &amp;= \mathbb{P}(\text{Stop after stage }j\text{ and reject }H_0 \mid \boldsymbol{\pi},\mathscr{D}),\\
  F_j(\boldsymbol{\pi}) &amp;= \mathbb{P}(\text{Stop after stage }j\text{ and do not reject }H_0 \mid \boldsymbol{\pi},\mathscr{D}),\\
  S_j(\boldsymbol{\pi}) &amp;= E_j(\boldsymbol{\pi}) + F_j(\boldsymbol{\pi}),
\end{align}\]</span></p>
<p>where we use the letters <span class="math inline">\(E\)</span>, <span class="math inline">\(F\)</span>, and <span class="math inline">\(S\)</span> to signify efficacy (i.e., activity), futility (i.e., lack of activity), and stopping respectively. We can also think about the above via the following equations</p>
<p><span class="math display">\[\begin{align}
  E_1(\boldsymbol{\pi}) &amp;= \mathbb{P}(\boldsymbol{T}_1 \in \mathscr{R}_1 \mid \boldsymbol{\pi},\mathcal{D}),\\
  F_1(\boldsymbol{\pi}) &amp;= \mathbb{P}(\boldsymbol{T}_1 \in \mathscr{N}_1 \mid \boldsymbol{\pi},\mathcal{D}),\\
  S_1(\boldsymbol{\pi}) &amp;= \mathbb{P}(\boldsymbol{T}_1 \notin \mathscr{C}_1 \mid \boldsymbol{\pi},\mathcal{D}),\\
\end{align}\]</span></p>
<p>and for <span class="math inline">\(j\in\{2,\dots,J\}\)</span></p>
<p><span class="math display">\[\begin{align}
  E_j(\boldsymbol{\pi}) &amp;= \mathbb{P}(\boldsymbol{T}_1 \in \mathscr{C}_1,\dots,\boldsymbol{T}_{j-1}\in \mathscr{C}_{j-1},\boldsymbol{T}_j \in \mathscr{R}_j \mid \boldsymbol{\pi},\mathcal{D}),\\
  F_j(\boldsymbol{\pi}) &amp;= \mathbb{P}(\boldsymbol{T}_1 \in \mathscr{C}_1,\dots,\boldsymbol{T}_{j-1}\in \mathscr{C}_{j-1},\boldsymbol{T}_j \in \mathscr{N}_j \mid \boldsymbol{\pi},\mathcal{D}),\\
  S_j(\boldsymbol{\pi}) &amp;= \mathbb{P}(\boldsymbol{T}_1 \in \mathscr{C}_1,\dots,\boldsymbol{T}_{j-1}\in \mathscr{C}_{j-1},\boldsymbol{T}_j \notin \mathscr{C}_j \mid \boldsymbol{\pi},\mathcal{D}).
\end{align}\]</span></p>
<p>Then, also of much interest will be the trials expected sample size under given response rates. To this end, denote by <span class="math inline">\(N\)</span> the random variable giving the total sample size required by a trial, and set</p>
<p><span class="math display">\[\tilde{n}_{jk} = \sum_{l=1}^j n_{lk},\qquad k\in\{C,E\}. \]</span> Then, we simultaneously define and compute the expected sample size as follows</p>
<p><span class="math display">\[ ESS(\boldsymbol{\pi}) = \mathbb{E}(N \mid \boldsymbol{\pi},\mathcal{D}) = \sum_{j=1}^J S_j(\boldsymbol{\pi})\left(\tilde{n}_{jC} + \tilde{n}_{jE}\right). \]</span> We will also consider the standard deviation of the required sample size</p>
<p><span class="math display">\[\begin{align}
SDSS(\boldsymbol{\pi}) &amp;= \mathbb{E}(N^2 \mid \boldsymbol{\pi},\mathcal{D}) - \mathbb{E}(N \mid \boldsymbol{\pi},\mathcal{D})^2,\\
&amp;= \sum_{j=1}^J S_j(\boldsymbol{\pi})\left(\tilde{n}_{jC} + \tilde{n}_{jE}\right)^2 - ESS(\boldsymbol{\pi})^2.
\end{align}\]</span></p>
<p>Next, setting <span class="math inline">\(\tilde{S}_j(\boldsymbol{\pi}) = S_1(\boldsymbol{\pi}) + \cdots + S_j(\boldsymbol{\pi})\)</span> and <span class="math inline">\(l = \text{argmin}_{j=1,\dots,J}\{\tilde{S}_j(\boldsymbol{\pi}) \ge 0.5\}\)</span>, we signify the median required sample size by</p>
<p><span class="math display">\[ MSS(\boldsymbol{\pi}) = \begin{cases} \tilde{n}_{lC} + \tilde{n}_{lE} + 0.5(n_{l+1C} + n_{l+1E}) \ &amp;: \ \tilde{S}_l(\boldsymbol{\pi}) = 0.5, \\ \tilde{n}_{lC} + \tilde{n}_{lE} \ &amp;: \ \tilde{S}_l(\boldsymbol{\pi}) \neq 0.5. \end{cases} \]</span> Finally, we will denote the maximum possible value of <span class="math inline">\(N\)</span> by <span class="math inline">\(\max N = \tilde{n}_{JC} + \tilde{n}_{JE}\)</span>.</p>
</div>
<div id="optimality-criteria" class="section level2">
<h2 class="hasAnchor">
<a href="#optimality-criteria" class="anchor"></a>2.3. Optimality criteria</h2>
<p>Designs that meet the desired type-I and type-II error-rate criteria are known as feasible. Within <strong>ph2rand</strong>, feasible designs are identified by searching over a discrete set of possible trial designs, as is described further in Section 4.1.</p>
<p>Then, for a one-stage trial design, <strong>ph2rand</strong> defines the optimal design as the feasible design that has the largest value of <span class="math inline">\(\min_{\pi\in\Pi_1} P\{(\pi,\pi+\delta)^\top\}\)</span>, amongst the feasible designs with the smallest value of <span class="math inline">\(\max N\)</span>. For each of the designs currently supported this guarantees a unique optimal design.</p>
<p>For designs with <span class="math inline">\(J&gt;1\)</span>, a more flexible optimality criteria is supported that builds upon that used, for example, in Jung <em>et al</em> (2004), Mander <em>et al</em> (2012), Wason <em>et al</em> (2012), and Wason (2015). Precisely, a set of weights, <span class="math inline">\(w_1,\dots,w_5\in[0,\infty)\)</span>, are selected. As is a value <span class="math inline">\(\pi_\text{O}\in[0,1-\delta]\)</span>. Then, the optimal design is that, amongst the feasible designs, which minimises the following criteria</p>
<p><span class="math display">\[\begin{multline}
w_1ESS\{(\pi_\text{O},\pi_\text{O})^\top\} + w_2ESS\{(\pi_\text{O},\pi_\text{O} + \delta)^\top\} + w_3\max_{\pi\in[0,1]}ESS\{(\pi,\pi)^\top\}\\
+ w_4\max_{\boldsymbol{\pi}\in[0,1]^2}ESS(\boldsymbol{\pi}) + w_5\max N.
\end{multline}\]</span></p>
<p>In general, <span class="math inline">\(\pi_\text{O}\)</span> should likely be chosen as the anticipated response rate in the control arm. In addition, it should typically be ensured that <span class="math inline">\(w_1+\cdots+w_4&gt;0\)</span>, as many designs will likely share the same minimal maximal sample size. Note that there is no available result that guarantees the above criteria and the given restrictions on the weights will lead to a unique optimal design. However, in practice, this is almost certain to be the case. Additionally, note that in general setting <span class="math inline">\(w_3&gt;0\)</span> or <span class="math inline">\(w_4&gt;0\)</span> may be illogical unless both efficacy and futility stopping is permitted (see later), as their associated <span class="math inline">\(\max ESS\)</span> criteria may be equal to <span class="math inline">\(\max N\)</span> otherwise.</p>
</div>
<div id="supported-designs" class="section level2">
<h2 class="hasAnchor">
<a href="#supported-designs" class="anchor"></a>2.4. Supported designs</h2>
<p>Currently, <strong>ph2rand</strong> supports the determination of four different types of randomised comparative design, all in one-stage and two-stage forms (i.e., they each support <span class="math inline">\(J\in\{1,2\}\)</span>). Each is described in its own subsection below.</p>
<p>Note that in all instances the values <span class="math inline">\(n_{jk}\)</span> are determined by searching over possible values for the <span class="math inline">\(n_{jC}\)</span>, assuming that <span class="math inline">\(n_{jE}=rn_{jC}\)</span> for a specified allocation ratio <span class="math inline">\(r\)</span>.</p>
<p>Furthermore, in what follows the following notation will be helpful</p>
<p><span class="math display">\[\begin{align}
x_{jk}         &amp;= \sum_{i=1}^{n_{jk}} y_{ijk},\qquad k\in\{C,E\},\\
z_j            &amp;= x_{jC} + x_{jE},\\
\tilde{x}_{jk} &amp;= x_{1k} + \cdots + x_{jk},\\
\tilde{z}_j    &amp;= z_1 + \cdots + z_j.
\end{align}\]</span></p>
<div id="jung-2008" class="section level3">
<h3 class="hasAnchor">
<a href="#jung-2008" class="anchor"></a>2.4.1. Jung (2008)</h3>
<p>Jung (2008), in combination with further details provided in Jung (2013), outlines a design framework based on exact binomial tests. Specifically, the following test statistic is used at the end of stage <span class="math inline">\(j\in\{1,\dots,J\}\)</span> <span class="math display">\[ \boldsymbol{t}_j = t_{Dj} = \tilde{x}_{jE} - \tilde{x}_{lC}. \]</span> That is, the difference between the number of responses observed on the experimental and control arms is used. Note that <span class="math inline">\(\mathscr{t}_j \subseteq \{-n_{C1}-\cdots-n_{Cj},\dots,n_{E1}+\cdots+n_{Ej}\}\)</span>; as noted earlier this is an important observation for efficient design determination.</p>
<p>This design then works by specifying the following rejection and non-rejection regions <span class="math display">\[\begin{align}
  \mathscr{R}_j &amp;= (e_j,\infty),\\
  \mathscr{N}_j &amp;= (-\infty,f_j].
\end{align}\]</span></p>
<p>Thus, for a <span class="math inline">\(J\)</span> stage design, parameters <span class="math inline">\(e_1,\dots,e_J\)</span> and <span class="math inline">\(f_1,\dots,f_J\)</span> are needed. For brevity, set <span class="math inline">\(\boldsymbol{e}=(e_1,\dots,e_J)\)</span> and <span class="math inline">\(\boldsymbol{f}=(f_1,\dots,f_J)\)</span>. With this, we have <span class="math inline">\(\mathcal{D} = \{\boldsymbol{n}_C,\boldsymbol{n}_E,\boldsymbol{e},\boldsymbol{f}\}\)</span>.</p>
<p>Note that with the above, if we wish to prevent early stopping for futility we can simply specify that <span class="math inline">\(f_j = -\infty\)</span> for <span class="math inline">\(j\in\{1,\dots,J-1\}\)</span>. Similarly, to prevent early stopping for efficacy, we can set <span class="math inline">\(e_1=\dots=e_{J-1}=\infty\)</span>.</p>
<p>Furthermore, note that in all cases <strong>ph2rand</strong> ensures that <span class="math inline">\(e_J = f_J\)</span>. This is enough to ensure that <span class="math inline">\(\mathscr{C}_J=\emptyset\)</span> and thus that a decision is made on <span class="math inline">\(H_0\)</span> by the trial’s completion and the study ends after at most <span class="math inline">\(J\)</span> stages. When <span class="math inline">\(J&gt;1\)</span>, it also ensures that <span class="math inline">\(e_j &gt; f_j\)</span> for <span class="math inline">\(j\in\{1,\dots,J-1\}\)</span>, in such a way that <span class="math inline">\(\mathscr{C}_j \neq \emptyset\)</span> for <span class="math inline">\(j\in\{1,\dots,J-1\}\)</span>.</p>
<p>Finally, note that because <span class="math inline">\(t_{Dj}\in\mathbb{Z}\)</span>, nothing is lost by making the assumption that <span class="math inline">\(e_j,f_j\in\mathbb{Z}\)</span>: <strong>ph2rand</strong> exploits this fact to search over possible designs as efficiently as possible. Specifically, as is discussed further in Section 3, the user specifies a range of allowed sample sizes. Then, <strong>ph2rand</strong> will search exhaustively over the designs that should be considered to evaluate all potential <em>different</em> options for the given sample sizes.</p>
</div>
<div id="shan-et-al-2013" class="section level3">
<h3 class="hasAnchor">
<a href="#shan-et-al-2013" class="anchor"></a>2.4.2. Shan <em>et al</em> (2013)</h3>
<p>Shan <em>et al</em> (2013) propose a framework similar to Jung (2008), but based on the following Barnard style test-statistics</p>
<p><span class="math display">\[ \boldsymbol{t}_j = t_{Bj} = \frac{\frac{\tilde{x}_{jE}}{\tilde{n}_{jE}} - \frac{\tilde{x}_{jC}}{\tilde{n}_{jC}}}{\frac{\tilde{z}_j}{\tilde{n}_{jC} + \tilde{n}_{jE}}\left(1 - \frac{\tilde{z}_j}{\tilde{n}_{jC} + \tilde{n}_{jE}} \right)\left( \frac{1}{\tilde{n}_{jC}} + \frac{1}{\tilde{n}_{jE}}  \right)}. \]</span> The rejection, non-rejection, and continuation regions are as in Section 2.4.1. So to does the design search procedure remain qualitatively the same (i.e., exhaustive evaluation of potential designs is still carried out). However, whilst the <span class="math inline">\(t_{Bj}\)</span> will still take a discrete set of possible values that can be used to limit the number of designs that should be considered, in this case <span class="math inline">\(t_{Bj}\in\mathbb{R}\)</span>, and thus we allow <span class="math inline">\(e_j,f_j\in\mathbb{R}\)</span> also.</p>
</div>
<div id="jung-and-sargent-2014" class="section level3">
<h3 class="hasAnchor">
<a href="#jung-and-sargent-2014" class="anchor"></a>2.4.3. Jung and Sargent (2014)</h3>
<p>Jung and Sargent (2014) propose a somewhat different design framework to those given above. Specifically, whilst the test statistic used in Jung (2008) is retained, the following rejection and non-rejection regions are nominated <span class="math display">\[\begin{align}
  \mathscr{R}_j &amp;= (e_{jz_1\dots z_j},\infty),\\
  \mathscr{N}_j &amp;= (-\infty,f_{jz_1\dots z_j}].
\end{align}\]</span> Thus, <span class="math inline">\(\mathscr{R}_j\)</span>, <span class="math inline">\(\mathscr{N}_j\)</span>, and <span class="math inline">\(\mathscr{C}_j\)</span> are allowed to vary based upon the the number of responses seen in the two arms in each stage.</p>
<p>Here, for brevity, we denote the <span class="math inline">\((\tilde{n}_{1C}+\tilde{n}_{1E}) \times \cdots \times (\tilde{n}_{jC}+\tilde{n}_{jE})\)</span> arrays of efficacy and futility stopping boundaries for use after stage <span class="math inline">\(j\)</span> by <span class="math inline">\(\boldsymbol{e}_j\)</span> and <span class="math inline">\(\boldsymbol{f}_j\)</span> respectively. Then, <span class="math inline">\(\mathcal{D} = \{\boldsymbol{n}_C,\boldsymbol{n}_E,\boldsymbol{e}_1,\dots,\boldsymbol{e}_J,\boldsymbol{f}_1,\dots,\boldsymbol{f}_J\}\)</span>.</p>
<p>Similarly to before, we can now prevent early stopping for efficacy or futility by prescribing that <span class="math inline">\(e_{jz_1\dots z_j}=\infty\)</span> and <span class="math inline">\(f_{jz_1\dots z_j}=-\infty\)</span> for <span class="math inline">\(j\in\{1,\dots,J\}\)</span> and <span class="math inline">\((z_1,\dots,z_j) \in \{0,\dots,\tilde{n}_{1C}+\tilde{n}_{1E}\}\times\cdots\times\{0,\dots,\tilde{n}_{jC}+\tilde{n}_{jE}\}\)</span>.</p>
<p>Unlike before, though, the boundaries are now not identified using an exhaustive search. Firstly, this is because this search procedure would be too computationally intensive to be useful in practice. However, the principal reason they are not chosen via an exhaustive assessment is because the motivation for this design framework comes from Fisher’s exact test and its approach to guaranteeing error control. See Jung and Sargent (2014) for further details.</p>
</div>
<div id="litwin-et-al-2017" class="section level3">
<h3 class="hasAnchor">
<a href="#litwin-et-al-2017" class="anchor"></a>2.4.4. Litwin <em>et al</em> (2017)</h3>
<p>The design from Litwin <em>et al</em> (2017) takes a different approach to those above and uses two test statistics to make a decision. Specifically, it combines testing rules typically associated with single-arm and two-arm trial designs, setting</p>
<p><span class="math display">\[ \boldsymbol{t}_j=(t_{Sj},t_{Dj})^\top = (\tilde{x}_{jE},\tilde{x}_{jE} - \tilde{x}_{jC}). \]</span> Then, the rejection and non-rejection regions are <span class="math display">\[\begin{align}
  \mathscr{R}_j &amp;= (e_{Sj},\infty)\times(e_{Tj},\infty),\\
  \mathscr{N}_j &amp;= \{(-\infty,f_{sj}]\times\mathbb{R}\}\cup\{\mathbb{R}\times(-\infty,f_{Tj}]\}.
\end{align}\]</span> Thus, for a <span class="math inline">\(J\)</span> stage design, parameters <span class="math inline">\(e_{S1},\dots,e_{SJ}\)</span>, <span class="math inline">\(e_{T1},\dots,e_{TJ}\)</span>, <span class="math inline">\(f_{S1},\dots,f_{SJ}\)</span>, and <span class="math inline">\(f_{T1},\dots,f_{TJ}\)</span> are needed. For brevity, set <span class="math inline">\(\boldsymbol{e}_S=(e_{S1},\dots,e_{SJ})\)</span>, <span class="math inline">\(\boldsymbol{e}_T=(e_{T1},\dots,e_{TJ})\)</span>, <span class="math inline">\(\boldsymbol{f}_S=(f_{S1},\dots,f_{SJ})\)</span>, and <span class="math inline">\(\boldsymbol{f}_T=(f_{T1},\dots,f_{TJ})\)</span>. With this, we have <span class="math inline">\(\mathcal{D} = \{\boldsymbol{n}_C,\boldsymbol{n}_E,\boldsymbol{e}_S,\boldsymbol{e}_T,\boldsymbol{f}_S,\boldsymbol{f}_T\}\)</span>.</p>
<p>Furthermore, in this case, early stopping for futility can be prevented by setting <span class="math inline">\(f_{S1}=\cdots=f_{SJ-1}=f_{T1}=\cdots=f_{TJ-1}=-\infty\)</span>. Similarly, early stopping for efficacy can be prevented by setting <span class="math inline">\(e_{S1}=\cdots=e_{SJ-1}=e_{T1}=\cdots=e_{TJ-1}=\infty\)</span>.</p>
<p>As for the designs from Jung (2008) and Shan <em>et al</em> (2013) described above, optimal designs are again identified via an exhaustive search procedure. Here, we make use of the fact that nothing is lost from assuming <span class="math inline">\(\boldsymbol{e}_S,\boldsymbol{e}_T,\boldsymbol{f}_S,\boldsymbol{f}_T\in\mathbb{Z}^J\)</span>. Furthermore, <strong>ph2rand</strong> enforces <span class="math inline">\(e_{SJ} = f_{SJ}\)</span> and <span class="math inline">\(e_{TJ} = f_{TJ}\)</span>, which ensures <span class="math inline">\(\mathscr{C}_J=\emptyset\)</span>. When <span class="math inline">\(J&gt;1\)</span>, it also makes particular restrictions such that <span class="math inline">\(e_{Sj} &gt; f_{Sj}\)</span> and <span class="math inline">\(e_{Tj} &gt; f_{Tj}\)</span> which ensure <span class="math inline">\(\mathscr{C}_j \neq \emptyset\)</span> for <span class="math inline">\(j\in\{1,\dots,J-1\}\)</span>.</p>
</div>
</div>
</div>
<div id="available-functions" class="section level1">
<h1 class="hasAnchor">
<a href="#available-functions" class="anchor"></a>3. Available functions</h1>
<p>At present, <strong>ph2rand</strong> exports ten functions for user use, each of which is described in detail below.</p>
<p>Note that the computations in all of the functions except <code><a href="../reference/sim.html">sim()</a></code> are performed using exact binomial probabilities, without recourse to simulation or numerical approximations. Consequently, for all of these we should always have that <span class="math inline">\(S_1(\boldsymbol{\pi}) + \cdots + S_J(\boldsymbol{\pi}) = 1\)</span>, and <span class="math inline">\(P(\boldsymbol{\pi}) = E_1(\boldsymbol{\pi}) + \cdots + E_J(\boldsymbol{\pi})\)</span>.</p>
<p>In addition, where helpful <strong>Rcpp</strong> is utilised in order to speed up the evaluations. Nonetheless, notes are given below on options that may substantially increase run time.</p>
<div id="des_one_stage" class="section level2">
<h2 class="hasAnchor">
<a href="#des_one_stage" class="anchor"></a>3.1. <code>des_one_stage()</code>
</h2>
<p><code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> determines one-stage two-arm randomised clinical trial designs within the framework described above (i.e., in particular assuming the primary outcome variable is Bernoulli distributed). In all instances, <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> computes the optimal required sample size in each arm, the associated optimal stopping boundaries, and returns information on key operating characteristics.</p>
<p>It allows the following inputs to be specified</p>
<ul>
<li>
<code>type</code>: A <code>character</code> string indicating the chosen design framework/test statistic to assume. Must be one of <code>"barnard"</code> (see Section 2.4.2), <code>"binomial"</code> (Section 2.4.1), <code>"fisher"</code> (Section 2.4.3), or <code>"sat"</code> (Section 2.4.4). Defaults to <code>"binomial"</code>.</li>
<li>
<code>alpha</code>: A <code>numeric</code> indicating the chosen value for <span class="math inline">\(\alpha\)</span>, the significance level (i.e., the type-I error-rate). Defaults to <code>0.1</code>.</li>
<li>
<code>beta</code>: A <code>numeric</code> indicating the chosen value for <span class="math inline">\(\beta\)</span>, used in the definition of the desired power (i.e., the type-II error-rate). Defaults to <code>0.2</code>.</li>
<li>
<code>delta</code>: A <code>numeric</code> indicating the chosen value for <span class="math inline">\(\delta\)</span>, the treatment effect assumed in the power calculation. Defaults to <code>0.2</code>.</li>
<li>
<code>ratio</code>: A <code>numeric</code> indicating the chosen value for <span class="math inline">\(r\)</span>, the allocation ratio to the experimental arm, relative to the control arm. Defaults to <code>1</code>.</li>
<li>
<code>Pi0</code>: A <code>numeric</code> <code>vector</code> indicating the chosen value for <span class="math inline">\(\Pi_0\)</span>, the control arm response rates to control the type-I error-rate to level <span class="math inline">\(\alpha\)</span> for. Must either be of <code>length</code> one, indicating a single point, or of <code>length</code> two. In this case, the elements indicate the range of possible response rates to allow for. Defaults to <code>0.1</code>.</li>
<li>
<code>Pi1</code>: A <code>numeric</code> <code>vector</code> indicating the chosen value for <span class="math inline">\(\Pi_1\)</span>s, the control arm response rates to allow for in the power calculations. Must either be of <code>length</code> one, indicating a single point, or of <code>length</code> two. In this case, the elements indicate the range of possible response rates to allow for. Defaults to <code>Pi0[1]</code>.</li>
<li>
<code>nCmax</code>: A <code>numeric</code> indicating the maximum value of the sample size in the control arm, <span class="math inline">\(\tilde{n}_{JC}\)</span>, to consider in the search procedure. Defaults to <code>50L</code>.</li>
<li>
<code>summary</code>: A <code>logical</code> variable indicating whether a summary of the function’s progress should be printed to the console. Defaults to <code>F</code>.</li>
</ul>
<p>It returns a <code>list</code> with additional class <code>"ph2rand_des"</code>, containing each of the input parameters along with several additional variables, including</p>
<ul>
<li>A <code>list</code> in the slot <code>$boundaries</code> giving the rejection boundary/boundaries of the optimal design. The names of these elements depends on the value of <code>type</code>.</li>
<li>A <code>tibble</code> in the slot <code>$feasible</code> summarising the operating characteristics of the feasible designs.</li>
<li>A <code>numeric</code> in the slot <code>$nC</code> giving the sample size in the control arm, <span class="math inline">\(n_{1C}\)</span>, for the optimal design.</li>
<li>A <code>numeric</code> in the slot <code>$nE</code> giving the sample size in the experimental arm, <span class="math inline">\(n_{1E}\)</span>, for the optimal design.</li>
<li>A <code>tibble</code> in the slot <code>$opchar</code> summarising the operating characteristics of the optimal design.</li>
</ul>
</div>
<div id="des_two_stage" class="section level2">
<h2 class="hasAnchor">
<a href="#des_two_stage" class="anchor"></a>3.2. <code>des_two_stage()</code>
</h2>
<div id="inputs-and-outputs" class="section level3">
<h3 class="hasAnchor">
<a href="#inputs-and-outputs" class="anchor"></a>3.2.1. Inputs and outputs</h3>
<p><code><a href="../reference/des_two_stage.html">des_two_stage()</a></code> determines two-stage two-arm randomised clinical trial designs within the framework described above (i.e., in particular assuming the primary outcome variable is Bernoulli distributed). In all instances, <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code> computes the optimal required sample size in each arm in each stage, the associated optimal stopping boundaries, and returns information on key operating characteristics.</p>
<p>It allows the following inputs to be specified</p>
<ul>
<li>
<code>type</code>: A <code>character</code> string indicating the chosen design framework/test statistic to assume. Must be one of <code>"barnard"</code> (see Section 2.4.2), <code>"binomial"</code> (Section 2.4.1), <code>"fisher"</code> (Section 2.4.3), or <code>"sat"</code> (Section 2.4.4). Defaults to <code>"binomial"</code>.</li>
<li>
<code>alpha</code>: A <code>numeric</code> indicating the chosen value for <span class="math inline">\(\alpha\)</span>, the significance level (i.e., the type-I error-rate). Defaults to <code>0.1</code>.</li>
<li>
<code>beta</code>: A <code>numeric</code> indicating the chosen value for <span class="math inline">\(\beta\)</span>, used in the definition of the desired power (i.e., the type-II error-rate). Defaults to <code>0.2</code>.</li>
<li>
<code>delta</code>: A <code>numeric</code> indicating the chosen value for <span class="math inline">\(\delta\)</span>, the treatment effect assumed in the power calculation. Defaults to <code>0.2</code>.</li>
<li>
<code>ratio</code>: A <code>numeric</code> indicating the chosen value for <span class="math inline">\(r\)</span>, the allocation ratio to the experimental arm, relative to the control arm. Defaults to <code>1</code>.</li>
<li>
<code>Pi0</code>: A <code>numeric</code> <code>vector</code> indicating the chosen value for <span class="math inline">\(\Pi_0\)</span>, the control arm response rates to control the type-I error-rate to level <span class="math inline">\(\alpha\)</span> for. Must either be of <code>length</code> one, indicating a single point, or of <code>length</code> two. In this case, the elements indicate the range of possible response rates to allow for. Defaults to <code>0.1</code>.</li>
<li>
<code>Pi1</code>: A <code>numeric</code> <code>vector</code> indicating the chosen value for <span class="math inline">\(\Pi_1\)</span>s, the control arm response rates to allow for in the power calculations. Must either be of <code>length</code> one, indicating a single point, or of <code>length</code> two. In this case, the elements indicate the range of possible response rates to allow for. Defaults to <code>Pi0[1]</code>.</li>
<li>
<code>nCmax</code>: A <code>numeric</code> indicating the maximum value of the sample size in the control arm (across both stage), <span class="math inline">\(\tilde{n}_{JC}\)</span>, to consider in the search procedure. Defaults to <code>50L</code>.</li>
<li>
<code>equal</code>: A <code>logical</code> variable indicating whether the sample size of the two stages should be equal (i.e., whether we should enforce <span class="math inline">\(n_{1C}=n_{2C}\)</span> and <span class="math inline">\(n_{1E}=n_{2E}\)</span>). Defaults to <code>T</code>.</li>
<li>
<code>w</code>: A <code>numeric</code> <code>vector</code> indicating the weights to use in the optimality criteria. Must be of <code>length</code> five, with all elements greater than or equal to zero, and at least one of the first four elements strictly positive. Defaults to <code><a href="https://rdrr.io/r/base/c.html">c(1, 0, 0, 0, 0)</a></code>.</li>
<li>
<code>piO</code>: A <code>numeric</code> indicating the chosen value of <span class="math inline">\(\pi_O\)</span>, the control arm response rate to assume in the optimality criteria. Defaults to <code>Pi0[1]</code>.</li>
<li>
<code>efficacy</code>: Only used if <code>type</code> is one of <code>"barnard"</code>, <code>"binomial"</code>, or <code>"sat"</code>. Then, it is a <code>logical</code> variable indicating whether to include early stopping for efficacy in the design. Defaults to <code>F</code>.</li>
<li>
<code>futility</code>: Only used if <code>type</code> is one of <code>"barnard"</code>, <code>"binomial"</code>, or <code>"sat"</code>. Then, it is a <code>logical</code> variable indicating whether to include early stopping for futility in the design. Defaults to <code>T</code>.</li>
<li>
<code>efficacy_type</code>: Only used if <code>type</code> is <code>"fisher"</code>. Then, it is a <code>numeric</code> indicating whether, and which type of, early stopping for efficacy to include in the design. See below for details. Defaults to <code>0L</code>.</li>
<li>
<code>efficacy_param</code>: Only used if <code>type</code> is <code>"fisher"</code> and <code>efficacy_type</code> is not equal to <code>0L</code>. Then, it is a <code>numeric</code> that influences the precise way in which an efficacy boundary is specified. See below for details. Defaults to <code>NULL</code>.</li>
<li>
<code>futility_type</code>: Only used if <code>type</code> is <code>"fisher"</code>. Then, it is a <code>numeric</code> indicating whether, and which type of, early stopping for futility to include in the design. See below for details. Defaults to <code>1L</code>.</li>
<li>
<code>futility_param</code>: Only used if <code>type</code> is <code>"fisher"</code> and <code>futility_type</code> is not equal to <code>0L</code>. Then, it is a <code>numeric</code> that influences the precise way in which a futility boundary is specified. See below for details. Defaults to <code>1L</code>.</li>
<li>
<code>summary</code>: A <code>logical</code> variable indicating whether a summary of the function’s progress should be printed to the console. Defaults to <code>F</code>.</li>
</ul>
<p>It returns a <code>list</code> with additional class <code>"ph2rand_des"</code>, containing each of the input parameters along with several additional variables, including</p>
<ul>
<li>A <code>list</code> in the slot <code>$boundaries</code> giving the rejection boundary/boundaries of the optimal design. The names of these elements depends on the value of <code>type</code>.</li>
<li>A <code>tibble</code> in the slot <code>$feasible</code> summarising the operating characteristics of the feasible designs.</li>
<li>A <code>numeric</code> in the slot <code>$nC</code> giving the sample sizes in the control arm in each stage, <span class="math inline">\(\boldsymbol{n}_C=(n_{1C},\dots,n_{JC})^\top\)</span>, for the optimal design.</li>
<li>A <code>numeric</code> in the slot <code>$nE</code> giving the sample sizes in the experimental arm in each stage, <span class="math inline">\(\boldsymbol{n}_E=(n_{1E},\dots,n_{JE})^\top\)</span>, for the optimal design.</li>
<li>A <code>tibble</code> in the slot <code>$opchar</code> summarising the operating characteristics of the optimal design.</li>
</ul>
</div>
<div id="stopping-boundaries-when-type-fisher" class="section level3">
<h3 class="hasAnchor">
<a href="#stopping-boundaries-when-type-fisher" class="anchor"></a>3.2.2. Stopping boundaries when <code>type = "fisher"</code>
</h3>
<p>When <code>type = "fisher"</code>, the input parameters <code>efficacy_type</code>, <code>efficacy_param</code>, <code>futility_type</code>, and <code>futility_param</code> allow for highly flexible choices for how to specify <span class="math inline">\(\boldsymbol{e}_1\)</span> and <span class="math inline">\(\boldsymbol{f}_1\)</span> {<span class="math inline">\(\boldsymbol{e}_2\)</span> always being computed as in Jung and Sargent (2014)}. Specifically, <code>efficacy_type</code> must be equal to <code>0</code>, <code>1</code>, or <code>2</code>. Then - A value of <code>0</code> indicates that early stopping for efficacy should be prevented. - For a value of <code>1</code>, <code>efficacy_param</code> can then be set to <code>NULL</code> or any single <code>numeric</code> whole number. When it is <code>NULL</code>, <strong>ph2rand</strong> sets <span class="math display">\[ e_{1z_1} = [0.5(n_{1C} + n_{1E})\delta]_* + 1,\]</span> where <span class="math inline">\([x]_*\)</span> indicates the nearest whole number to <span class="math inline">\(x\)</span>, as originally proposed by Jung and Sargent (2014). When it is any given whole number, <span class="math inline">\(e\)</span> say, it sets <span class="math inline">\(e_{1z_1}=e\)</span> for all <span class="math inline">\(z_1\)</span>. - For a value of <code>2</code>, <code>efficacy_param</code> must be a single <code>numeric</code> in the range <span class="math inline">\((0,1)\)</span>. If we refer to this as <span class="math inline">\(\alpha_1\)</span>, say, then <strong>ph2rand</strong> chooses <span class="math inline">\(e_{1z_1}\)</span> as <span class="math display">\[ e_{1z_1} = \text{argmin}_{e\in\{-n_{C1},\dots,n_{E1}\}} [\text{max}_{\pi\in\Pi_0} E_1\{(\pi,\pi)^\top\} \le \alpha_1].\]</span> Similarly, <code>futility_type</code> must also be equal to <code>0</code>, <code>1</code>, or <code>2</code>. In this case - A value of <code>0</code> indicates that early stopping for futility should be prevented. - For a value of <code>1</code>, <code>futility_param</code> must be a single <code>numeric</code> whole number. If this is <span class="math inline">\(f\)</span>, say, <strong>ph2rand</strong> sets $ f_{1z_1} = f$ for all <span class="math inline">\(z_1\)</span>. - For a value of <code>2</code>, <code>futility_param</code> must be a single <code>numeric</code> in the range <span class="math inline">\((0,1)\)</span>. If we refer to this as <span class="math inline">\(\beta_1\)</span>, say, then <strong>ph2rand</strong> chooses <span class="math inline">\(f_{1z_1}\)</span> as <span class="math display">\[ f_{1z_1} = \text{argmax}_{f\in\{-n_{C1},\dots,n_{E1}\}} [\text{max}_{\pi\in\Pi_1} F_1\{(\pi,\pi+\delta)^\top\} \le \beta_1].\]</span></p>
</div>
</div>
<div id="terminal" class="section level2">
<h2 class="hasAnchor">
<a href="#terminal" class="anchor"></a>3.3. <code>terminal()</code>
</h2>
<p><code><a href="../reference/terminal.html">terminal()</a></code> determines the <em>terminal</em> points of a design returned by <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> or <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code>, along with their associated decisions. That is, it returns all possible values of the number of responses that could be observed in the arms (stratified by stage where relevant), gives details on what the associated test statistic(s) would be, and provides information on what the decision would be in regards to <span class="math inline">\(H_0\)</span>. For two-stage designs it also provides details on the scenarios that would lead to continuation to stage two at the interim analysis.</p>
<p>It allows the following inputs to be specified</p>
<ul>
<li>
<code>des</code>: An object of class <code>"ph2rand_des"</code>, as returned by <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> or <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code>. Defaults to <code><a href="../reference/des_one_stage.html">ph2rand::des_one_stage()</a></code>.</li>
<li>
<code>k</code>: A <code>numeric</code> <code>vector</code> indicating which stages to consider when determining the terminal points. Defaults to <code>1:des$J</code> (i.e., to all stages of the given design).</li>
<li>
<code>summary</code> A <code>logical</code> variable indicating whether a summary of the function’s progress should be printed to the console. Defaults to <code>F</code>.</li>
</ul>
<p>It returns a <code>list</code> with additional class <code>"ph2rand_terminal"</code>, containing each of the input parameters along with a tibble in the slot <code>$terminal</code>, which gives the determined terminal points.</p>
</div>
<div id="pmf" class="section level2">
<h2 class="hasAnchor">
<a href="#pmf" class="anchor"></a>3.4. <code>pmf()</code>
</h2>
<p><code><a href="../reference/pmf.html">pmf()</a></code> analytically determines probability mass functions of a design returned by <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> or <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code>, under given response rate scenarios (see <code>pi</code>).</p>
<p>It allows the following inputs to be specified</p>
<ul>
<li>
<code>des</code>: An object of class <code>"ph2rand_des"</code>, as returned by <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> or <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code>. Defaults to <code><a href="../reference/des_one_stage.html">ph2rand::des_one_stage()</a></code>.</li>
<li>
<code>pi</code>: A <code>numeric</code> <code>vector</code> with two elements, or <code>numeric</code> <code>matrix</code> or <code>data.frame</code> with two columns, giving the response rate scenarios to consider. The first element/column should correspond to the control arm and the second element/column to the experimental arm. Defaults to <code>des$opchar[, 1:2]</code>.</li>
<li>
<code>k</code>: A <code>numeric</code> <code>vector</code> indicating which stages to consider in determining the probability mass functions. That is, it will condition the calculations on the trial ending in the stages given in <code>k</code>. Defaults to <code>1:des$J</code> (i.e., to all stages of the given design).</li>
<li>
<code>summary</code>: A <code>logical</code> variable indicating whether a summary of the function’s progress should be printed to the console. Defaults to <code>F</code>.</li>
</ul>
<p>It returns a <code>list</code> with additional class <code>"ph2rand_pmf"</code>, containing each of the input parameters along with a tibble in the slot <code>$pmf</code>, which gives the determined probability mass functions.</p>
</div>
<div id="opchar" class="section level2">
<h2 class="hasAnchor">
<a href="#opchar" class="anchor"></a>3.5. <code>opchar()</code>
</h2>
<p><code><a href="../reference/opchar.html">opchar()</a></code> analytically determines the operating characteristics of a design returned by <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> or <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code>, under given response rate scenarios (see <code>pi</code>).</p>
<p>It allows the following inputs to be specified</p>
<ul>
<li>
<code>des</code>: An object of class <code>"ph2rand_des"</code>, as returned by <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> or <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code>. Defaults to <code><a href="../reference/des_one_stage.html">ph2rand::des_one_stage()</a></code>.</li>
<li>
<code>pi</code>: A <code>numeric</code> <code>vector</code> with two elements, or <code>numeric</code> <code>matrix</code> or <code>data.frame</code> with two columns, giving the response rate scenarios to consider. The first element/column should correspond to the control arm and the second element/column to the experimental arm. Defaults to <code>des$opchar[, 1:2]</code>.</li>
<li>
<code>k</code>: A <code>numeric</code> <code>vector</code> indicating which stages to consider in determining the probability mass functions. That is, it will condition the calculations on the trial ending in the stages given in <code>k</code>. Defaults to <code>1:des$J</code> (i.e., to all stages of the given design).</li>
<li>
<code>summary</code>: A <code>logical</code> variable indicating whether a summary of the function’s progress should be printed to the console. Defaults to <code>F</code>.</li>
</ul>
<p>It returns a <code>list</code> with additional class <code>"ph2rand_opchar"</code>, containing each of the input parameters along with a tibble in the slot <code>$opchar</code>, which gives the determined operating characteristics.</p>
</div>
<div id="sim" class="section level2">
<h2 class="hasAnchor">
<a href="#sim" class="anchor"></a>3.6 <code>sim()</code>
</h2>
<p><code><a href="../reference/sim.html">sim()</a></code> determines the operating characteristics of a design returned by <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> or <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code>, under given response rate scenarios (see <code>pi</code>), via simulation.</p>
<p>It allows the following inputs to be specified</p>
<ul>
<li>
<code>des</code>: An object of class <code>"ph2rand_des"</code>, as returned by <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> or <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code>. Defaults to <code><a href="../reference/des_one_stage.html">ph2rand::des_one_stage()</a></code>.</li>
<li>
<code>pi</code>: A <code>numeric</code> <code>vector</code> with two elements, or <code>numeric</code> <code>matrix</code> or <code>data.frame</code> with two columns, giving the response rate scenarios to consider. The first element/column should correspond to the control arm and the second element/column to the experimental arm. Defaults to <code>des$opchar[, 1:2]</code>.</li>
<li>
<code>k</code>: A <code>numeric</code> <code>vector</code> indicating which stages to consider in determining the probability mass functions. That is, it will condition the calculations on the trial ending in the stages given in <code>k</code>. Defaults to <code>1:des$J</code> (i.e., to all stages of the given design).</li>
<li>
<code>replicates</code>: A <code>numeric</code> indicating the number of replicate simulations to use in estimating the operating characteristics. Defaults to <code>1e4</code>.</li>
<li>
<code>summary</code>: A <code>logical</code> variable indicating whether a summary of the function’s progress should be printed to the console. Defaults to <code>F</code>.</li>
</ul>
<p>It returns a <code>list</code> with additional class <code>"ph2rand_sim"</code>, containing each of the input parameters along with a tibble in the slot <code>$sim</code>, which gives the estimated operating characteristics.</p>
<p>See the other package vignette, accessible via <code>vignette("validation")</code>, for further discussion on how <code><a href="../reference/sim.html">sim()</a></code> can be used to confirm results determined by <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code>, <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code>, and <code><a href="../reference/opchar.html">opchar()</a></code>.</p>
</div>
<div id="plot-ph2rand_des" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-ph2rand_des" class="anchor"></a>3.7. <code>plot.ph2rand_des()</code>
</h2>
<p><code><a href="../reference/plot.ph2rand_des.html">plot.ph2rand_des()</a></code> plots the operating characteristics of a design returned by <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> or <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code>, under a range of key response rate scenarios. For convenience, it also calls <code><a href="../reference/plot.ph2rand_terminal.html">plot.ph2rand_terminal()</a></code> to plot the terminal points of the design.</p>
<p>It allows the following inputs to be specified</p>
<ul>
<li>
<code>x</code>: An object of class <code>"ph2rand_des"</code>, as returned by <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> or <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code>.</li>
<li>
<code>k</code>: A <code>numeric</code> <code>vector</code> indicating which stages to consider in determining the probability mass function. That is, it will condition the calculations on the trial ending in the stages given in <code>k</code>. Defaults to <code>1:des$J</code> (i.e., to all stages of the given design).</li>
<li>
<code>output</code>: A <code>logical</code> variable indicating whether available outputs should be returned by the function.</li>
</ul>
<p>If <code>output = T</code>, a <code>list</code> containing each of the input parameters along with a <code>list</code> in the slot <code>$plots</code>, which gives all of the available produced plots.</p>
</div>
<div id="summary-ph2rand_des" class="section level2">
<h2 class="hasAnchor">
<a href="#summary-ph2rand_des" class="anchor"></a>3.8. <code>summary.ph2rand_des()</code>
</h2>
<p><code><a href="../reference/summary.ph2rand_des.html">summary.ph2rand_des()</a></code> prints a summary of a design returned by <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> or <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code>.</p>
<p>It allows the following inputs to be specified</p>
<ul>
<li>
<code>x</code>: An object of class <code>"ph2rand_des"</code>, as returned by <code><a href="../reference/des_one_stage.html">des_one_stage()</a></code> or <code><a href="../reference/des_two_stage.html">des_two_stage()</a></code>.</li>
</ul>
</div>
<div id="plot-ph2rand_terminal" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-ph2rand_terminal" class="anchor"></a>3.9. <code>plot.ph2rand_terminal()</code>
</h2>
<p><code><a href="../reference/plot.ph2rand_terminal.html">plot.ph2rand_terminal()</a></code> plots the terminal points of a design, as returned by <code><a href="../reference/terminal.html">terminal()</a></code>.</p>
<p>It allows each of the following options to be specified</p>
<ul>
<li>
<code>x</code>: An object of class <code>"ph2rand_terminal"</code>, as returned by <code><a href="../reference/terminal.html">terminal()</a></code>.</li>
<li>
<code>output</code>: A <code>logical</code> variable indicating whether outputs should be returned by the function. Defaults to <code>F</code>.</li>
</ul>
<p>If <code>output = T</code>, it will return a <code>list</code> containing each of the input parameters along with a plot in the slot <code>$plot</code>, giving the produced plot of the terminal points.</p>
</div>
<div id="plot-ph2rand_pmf" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-ph2rand_pmf" class="anchor"></a>3.10. <code>plot.ph2rand_pmf()</code>
</h2>
<p><code><a href="../reference/plot.ph2rand_pmf.html">plot.ph2rand_pmf()</a></code> plots the probability mass functions of a design, as returned by <code><a href="../reference/pmf.html">pmf()</a></code>.</p>
<p>It allows the following inputs to be specified</p>
<ul>
<li>
<code>x</code>: An object of class <code>"ph2rand_pmf"</code>, as returned by <code><a href="../reference/pmf.html">pmf()</a></code>.</li>
<li>
<code>output</code>: A <code>logical</code> variable indicating whether outputs should be returned by the function. Defaults to <code>F</code>.</li>
</ul>
<p>If <code>output = T</code>, it will return a <code>list</code> containing each of the input parameters along with a <code>list</code> in the slot <code>$plots</code>, giving the produced plots of the probability mass functions.</p>
</div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>4. Examples</h1>
<div id="one-stage-design-using-jung-2008" class="section level2">
<h2 class="hasAnchor">
<a href="#one-stage-design-using-jung-2008" class="anchor"></a>4.1. One-stage design using Jung (2008)</h2>
<p>First, lets consider a simple scenario where we specify that <span class="math inline">\(\Pi_0=\Pi_1=0.1\)</span>, <span class="math inline">\(\delta=0.2\)</span>, <span class="math inline">\(\alpha=\beta=0.1\)</span>, <span class="math inline">\(r=1\)</span>, and that a one-stage design of the type from Jung (2008) will be used. We can find this design as follows</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw">des</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(type    = <span class="st">"binomial"</span>,
                     alpha   = <span class="fl">0.1</span>,
                     beta    = <span class="fl">0.1</span>,
                     delta   = <span class="fl">0.2</span>,
                     ratio   = <span class="fl">1</span>,
                     Pi0     = <span class="fl">0.1</span>,
                     Pi1     = <span class="fl">0.1</span>,
                     nCmax   = <span class="fl">50L</span>)
</pre></div>
<p>A simple summary can then be acquired with</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw">des</span>)
<span class="co">#&gt;   -------------------------------------------------</span>
<span class="co">#&gt;   A single-stage trial based on an exact binomial test</span>
<span class="co">#&gt;   -------------------------------------------------</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   ---------------</span>
<span class="co">#&gt;   Hypothesis test</span>
<span class="co">#&gt;   ---------------</span>
<span class="co">#&gt;   You have chosen to test the following hypothesis</span>
<span class="co">#&gt;     H0 : piE &lt;= piC</span>
<span class="co">#&gt;   with the following type-I error constraint</span>
<span class="co">#&gt;     P(0.1,0.1) &lt;= alpha = 0.1</span>
<span class="co">#&gt;   and the following type-II error constraint</span>
<span class="co">#&gt;     P(0.1,0.3) &gt;= 1 - beta = 0.9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   -----------------</span>
<span class="co">#&gt;   Design parameters</span>
<span class="co">#&gt;   -----------------</span>
<span class="co">#&gt;   The design has:</span>
<span class="co">#&gt;     - n1C = 40</span>
<span class="co">#&gt;     - n1E = 40</span>
<span class="co">#&gt;     - e1 = 4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   -------------------------</span>
<span class="co">#&gt;   Operating Characteristics</span>
<span class="co">#&gt;   -------------------------</span>
<span class="co">#&gt;   Key operating characteristics include</span>
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;     piC   piE `P(pi)`</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0.1   0.1  0.0940</span>
<span class="co">#&gt; 2   0.1   0.3  0.904</span>
</pre></div>
<p>We can plot the terminal points of this design with</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">term_des</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/terminal.html">terminal</a></span>(<span class="kw">des</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">term_des</span>)
<span class="co">#&gt; NULL</span>
</pre></div>
<p>We can also find and plot the probability mass function for <span class="math inline">\(\boldsymbol{\pi}=(0.1,0.1)^\top\)</span> and <span class="math inline">\(\boldsymbol{\pi}=(0.1,0.3)^\top\)</span> via</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">pmf_des</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmf.html">pmf</a></span>(<span class="kw">des</span>, pi = <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>),
                               <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>)))
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">pmf_des</span>)
</pre></div>
<p><img src="ph2rand_files/figure-html/eg41_4-1.png" width="1093.75"></p>
<p>The operating characteristics (i.e., power) under the same scenarios can be found and inspected with</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">opchar_des</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/opchar.html">opchar</a></span>(<span class="kw">des</span>, pi = <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>),
                                     <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>)))
<span class="kw">opchar_des</span><span class="op">$</span><span class="kw">opchar</span>
<span class="co">#&gt; # A tibble: 2 x 3</span>
<span class="co">#&gt;     piC   piE `P(pi)`</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0.1   0.1  0.0940</span>
<span class="co">#&gt; 2   0.1   0.3  0.904</span>
</pre></div>
<p>Finally, we can plot the power for a wider range of scenarios with</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">des</span>)
</pre></div>
<p><img src="ph2rand_files/figure-html/eg41_6-1.png" width="1093.75"><img src="ph2rand_files/figure-html/eg41_6-2.png" width="1093.75"></p>
</div>
<div id="comparing-one-stage-designs-across-design-frameworks" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-one-stage-designs-across-design-frameworks" class="anchor"></a>4.2. Comparing one-stage designs across design frameworks</h2>
<p>Now, to demonstrate the potential advantages of carefully choosing a design framework, lets consider another example with <span class="math inline">\(\Pi_0=\Pi_1=[0.1,0.3]\)</span>, <span class="math inline">\(\delta=0.25\)</span>, <span class="math inline">\(\alpha=0.05\)</span>, <span class="math inline">\(\beta=0.2\)</span>, and <span class="math inline">\(r=2\)</span>. A one-stage design of some kind will be used. We can find the optimal design for each of the four supported frameworks with</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">binomial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(type  = <span class="st">"binomial"</span>,
                          alpha = <span class="fl">0.05</span>,
                          beta  = <span class="fl">0.2</span>,
                          delta = <span class="fl">0.25</span>,
                          ratio = <span class="fl">2</span>,
                          Pi0   = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>),
                          Pi1   = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>),
                          nCmax = <span class="fl">50L</span>)
<span class="kw">barnard</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(type  = <span class="st">"barnard"</span>,
                          alpha = <span class="fl">0.05</span>,
                          beta  = <span class="fl">0.2</span>,
                          delta = <span class="fl">0.25</span>,
                          ratio = <span class="fl">2</span>,
                          Pi0   = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>),
                          Pi1   = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>),
                          nCmax = <span class="fl">50L</span>)
<span class="kw">fisher</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(type  = <span class="st">"fisher"</span>,
                          alpha = <span class="fl">0.05</span>,
                          beta  = <span class="fl">0.2</span>,
                          delta = <span class="fl">0.25</span>,
                          ratio = <span class="fl">2</span>,
                          Pi0   = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>),
                          Pi1   = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>),
                          nCmax = <span class="fl">50L</span>)
<span class="kw">sat</span>      <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(type  = <span class="st">"sat"</span>,
                          alpha = <span class="fl">0.05</span>,
                          beta  = <span class="fl">0.2</span>,
                          delta = <span class="fl">0.25</span>,
                          ratio = <span class="fl">2</span>,
                          Pi0   = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>),
                          Pi1   = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>),
                          nCmax = <span class="fl">50L</span>)
</pre></div>
<p>We can then compare the sample size required in the control arm for each of these designs with</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">binomial</span><span class="op">$</span><span class="kw">nC</span>
<span class="co">#&gt; [1] 43</span>
<span class="kw">barnard</span><span class="op">$</span><span class="kw">nC</span>
<span class="co">#&gt; [1] 35</span>
<span class="kw">fisher</span><span class="op">$</span><span class="kw">nC</span>
<span class="co">#&gt; [1] 42</span>
<span class="kw">sat</span><span class="op">$</span><span class="kw">nC</span>
<span class="co">#&gt; [1] 43</span>
</pre></div>
<p>Thus, the approach described in Shan <em>et al</em> (2013) is the most efficient in this case.</p>
</div>
<div id="the-effect-of-pi_0-and-pi_1-on-design-operating-characteristics" class="section level2">
<h2 class="hasAnchor">
<a href="#the-effect-of-pi_0-and-pi_1-on-design-operating-characteristics" class="anchor"></a>4.3. The effect of <span class="math inline">\(\Pi_0\)</span> and <span class="math inline">\(\Pi_1\)</span> on design operating characteristics</h2>
<p>Next, we will consider how the choice of <span class="math inline">\(\Pi_0\)</span> and <span class="math inline">\(\Pi_1\)</span> effects the optimal design. As an illustrative example, consider a one-stage design for <span class="math inline">\(\delta=0.3\)</span>, <span class="math inline">\(\alpha=0.05\)</span>, <span class="math inline">\(\beta=0.1\)</span>, and <span class="math inline">\(r=1\)</span>, using the binomial approach. First, let’s find the design for <span class="math inline">\(\Pi_0=\Pi_1=0.1\)</span>, inspect its required sample size in the control arm, and plot its operating characteristics</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">binomial_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(type  = <span class="st">"binomial"</span>,
                            alpha = <span class="fl">0.05</span>,
                            beta  = <span class="fl">0.1</span>,
                            delta = <span class="fl">0.3</span>,
                            ratio = <span class="fl">1</span>,
                            Pi0   = <span class="fl">0.1</span>,
                            Pi1   = <span class="fl">0.1</span>)
<span class="kw">binomial_1</span><span class="op">$</span><span class="kw">nC</span>
<span class="co">#&gt; [1] 24</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">binomial_1</span>)
</pre></div>
<p><img src="ph2rand_files/figure-html/eg43_1-1.png" width="1093.75"><img src="ph2rand_files/figure-html/eg43_1-2.png" width="1093.75"></p>
<p>Thus, <span class="math inline">\(24\)</span> patients are required in the control arm. Notice that there are many scenarios when the type-I error-rate is larger than <span class="math inline">\(0.05\)</span>, and where the power is below <span class="math inline">\(0.9\)</span>. To ensure the maximal type-I error-rate is below <span class="math inline">\(0.05\)</span>, and the maximal type-II error-rate is below <span class="math inline">\(0.1\)</span>, we can re-run the above modifying the values of <span class="math inline">\(\Pi_0\)</span> and <span class="math inline">\(\Pi_1\)</span></p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">binomial_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_one_stage.html">des_one_stage</a></span>(type  = <span class="st">"binomial"</span>,
                            alpha = <span class="fl">0.05</span>,
                            beta  = <span class="fl">0.1</span>,
                            delta = <span class="fl">0.3</span>,
                            ratio = <span class="fl">1</span>,
                            Pi0   = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>),
                            Pi1   = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.7</span>))
<span class="kw">binomial_2</span><span class="op">$</span><span class="kw">nC</span>
<span class="co">#&gt; [1] 49</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">binomial_2</span>)
</pre></div>
<p><img src="ph2rand_files/figure-html/eg43_2-1.png" width="1093.75"><img src="ph2rand_files/figure-html/eg43_2-2.png" width="1093.75"> As we can see, this does provide a design well controlling the type-I and type-II error-rates across possible values of the control arm. However, it has increased the required sample size in the control arm by more than <span class="math inline">\(100%\)</span> to 49.</p>
</div>
<div id="comparing-two-stage-designs-across-design-frameworks" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-two-stage-designs-across-design-frameworks" class="anchor"></a>4.4. Comparing two-stage designs across design frameworks</h2>
<p>Now lets repeat the example from Section 4.2, but for two-stage designs. For simplicity we set <span class="math inline">\(\Pi_0=\Pi_1=0.2\)</span> in this case. We also assume the default values for all of the two-stage specific design parameters. Thus, we can find the optimal design for each of the four supported frameworks with</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">binomial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(type  = <span class="st">"binomial"</span>,
                          alpha = <span class="fl">0.05</span>,
                          beta  = <span class="fl">0.2</span>,
                          delta = <span class="fl">0.25</span>,
                          ratio = <span class="fl">2</span>,
                          Pi0   = <span class="fl">0.2</span>,
                          Pi1   = <span class="fl">0.2</span>)
<span class="kw">barnard</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(type  = <span class="st">"barnard"</span>,
                          alpha = <span class="fl">0.05</span>,
                          beta  = <span class="fl">0.2</span>,
                          delta = <span class="fl">0.25</span>,
                          ratio = <span class="fl">2</span>,
                          Pi0   = <span class="fl">0.2</span>,
                          Pi1   = <span class="fl">0.2</span>,
                          nCmax = <span class="fl">40L</span>)
<span class="kw">fisher</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(type  = <span class="st">"fisher"</span>,
                          alpha = <span class="fl">0.05</span>,
                          beta  = <span class="fl">0.2</span>,
                          delta = <span class="fl">0.25</span>,
                          ratio = <span class="fl">2</span>,
                          Pi0   = <span class="fl">0.2</span>,
                          Pi1   = <span class="fl">0.2</span>)
<span class="kw">sat</span>      <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(type  = <span class="st">"sat"</span>,
                          alpha = <span class="fl">0.05</span>,
                          beta  = <span class="fl">0.2</span>,
                          delta = <span class="fl">0.25</span>,
                          ratio = <span class="fl">2</span>,
                          Pi0   = <span class="fl">0.2</span>,
                          Pi1   = <span class="fl">0.2</span>,
                          nCmax = <span class="fl">20L</span>)
</pre></div>
<p>We can then compare the sample size required in the control arm for each of these designs with</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">binomial</span><span class="op">$</span><span class="kw">nC</span>
<span class="co">#&gt; [1] 9 9</span>
<span class="kw">barnard</span><span class="op">$</span><span class="kw">nC</span>
<span class="co">#&gt; [1] 16 16</span>
<span class="kw">fisher</span><span class="op">$</span><span class="kw">nC</span>
<span class="co">#&gt; [1] 19 19</span>
<span class="kw">sat</span><span class="op">$</span><span class="kw">nC</span>
<span class="co">#&gt; [1] 7 7</span>
</pre></div>
<p>Thus, the approach described in Litwin <em>et al</em> (2017) appears to be easily the most efficient in this case. In general, however, we may wish to also inspect more detailed operating characteristics of the designs, as follows</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="kw">binomial</span><span class="op">$</span><span class="kw">opchar</span>
<span class="co">#&gt; # A tibble: 2 x 13</span>
<span class="co">#&gt;     piC   piE `P(pi)` `ESS(pi)` `SDSS(pi)` `MSS(pi)` `E1(pi)` `E2(pi)` `F1(pi)`</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0.2  0.2   0.0395      32.5      10.9         27        0   0.0395    0.797</span>
<span class="co">#&gt; 2   0.2  0.45  0.820       50.7       8.90        54        0   0.820     0.124</span>
<span class="co">#&gt; # … with 4 more variables: `F2(pi)` &lt;dbl&gt;, `S1(pi)` &lt;dbl&gt;, `S2(pi)` &lt;dbl&gt;, `max</span>
<span class="co">#&gt; #   N` &lt;int&gt;</span>
<span class="kw">barnard</span><span class="op">$</span><span class="kw">opchar</span>
<span class="co">#&gt; # A tibble: 2 x 13</span>
<span class="co">#&gt;     piC   piE `P(pi)` `ESS(pi)` `SDSS(pi)` `MSS(pi)` `E1(pi)` `E2(pi)` `F1(pi)`</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0.2  0.2   0.0499      65.3       23.0        48        0   0.0499   0.640 </span>
<span class="co">#&gt; 2   0.2  0.45  0.803       92.3       12.8        96        0   0.803    0.0777</span>
<span class="co">#&gt; # … with 4 more variables: `F2(pi)` &lt;dbl&gt;, `S1(pi)` &lt;dbl&gt;, `S2(pi)` &lt;dbl&gt;, `max</span>
<span class="co">#&gt; #   N` &lt;int&gt;</span>
<span class="kw">fisher</span><span class="op">$</span><span class="kw">opchar</span>
<span class="co">#&gt; # A tibble: 2 x 13</span>
<span class="co">#&gt;     piC   piE `P(pi)` `ESS(pi)` `SDSS(pi)` `MSS(pi)` `E1(pi)` `E2(pi)` `F1(pi)`</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0.2  0.2   0.0294      106.     19.5         114        0   0.0294 0.136   </span>
<span class="co">#&gt; 2   0.2  0.45  0.809       114.      0.662       114        0   0.809  0.000135</span>
<span class="co">#&gt; # … with 4 more variables: `F2(pi)` &lt;dbl&gt;, `S1(pi)` &lt;dbl&gt;, `S2(pi)` &lt;dbl&gt;, `max</span>
<span class="co">#&gt; #   N` &lt;int&gt;</span>
<span class="kw">sat</span><span class="op">$</span><span class="kw">opchar</span>
<span class="co">#&gt; # A tibble: 2 x 13</span>
<span class="co">#&gt;     piC   piE `P(pi)` `ESS(pi)` `SDSS(pi)` `MSS(pi)` `E1(pi)` `E2(pi)` `F1(pi)`</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0.2  0.2   0.0490      23.7       6.99        21        0   0.0490    0.873</span>
<span class="co">#&gt; 2   0.2  0.45  0.805       38.3       7.96        42        0   0.805     0.174</span>
<span class="co">#&gt; # … with 4 more variables: `F2(pi)` &lt;dbl&gt;, `S1(pi)` &lt;dbl&gt;, `S2(pi)` &lt;dbl&gt;, `max</span>
<span class="co">#&gt; #   N` &lt;int&gt;</span>
</pre></div>
<p>It is also important to evaluate the operating characteristics in more scenarios as, e.g., the type-I error-rate may be large in situations not allowed for in the design</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="kw">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">sat</span>, output = <span class="kw">T</span>)
<span class="kw">plots</span><span class="op">$</span><span class="kw">plots</span>
<span class="co">#&gt; $terminal</span>
</pre></div>
<p><img src="ph2rand_files/figure-html/eg44_4-1.png" width="1093.75"></p>
<pre><code>#&gt; 
#&gt; $grid
#&gt; $grid$`P(pi)`</code></pre>
<p><img src="ph2rand_files/figure-html/eg44_4-2.png" width="1093.75"></p>
<pre><code>#&gt; 
#&gt; $grid$`ESS(pi)`</code></pre>
<p><img src="ph2rand_files/figure-html/eg44_4-3.png" width="1093.75"></p>
<pre><code>#&gt; 
#&gt; $grid$rejection</code></pre>
<p><img src="ph2rand_files/figure-html/eg44_4-4.png" width="1093.75"></p>
<pre><code>#&gt; 
#&gt; $grid$stopping</code></pre>
<p><img src="ph2rand_files/figure-html/eg44_4-5.png" width="1093.75"></p>
<pre><code>#&gt; 
#&gt; 
#&gt; $null
#&gt; $null$`P(pi)`</code></pre>
<p><img src="ph2rand_files/figure-html/eg44_4-6.png" width="1093.75"></p>
<pre><code>#&gt; 
#&gt; $null$`ESS(pi)`</code></pre>
<p><img src="ph2rand_files/figure-html/eg44_4-7.png" width="1093.75"></p>
<pre><code>#&gt; 
#&gt; $null$rejection</code></pre>
<p><img src="ph2rand_files/figure-html/eg44_4-8.png" width="1093.75"></p>
<pre><code>#&gt; 
#&gt; $null$stopping</code></pre>
<p><img src="ph2rand_files/figure-html/eg44_4-9.png" width="1093.75"></p>
<pre><code>#&gt; 
#&gt; 
#&gt; $alt
#&gt; $alt$`P(pi)`</code></pre>
<p><img src="ph2rand_files/figure-html/eg44_4-10.png" width="1093.75"></p>
<pre><code>#&gt; 
#&gt; $alt$`ESS(pi)`</code></pre>
<p><img src="ph2rand_files/figure-html/eg44_4-11.png" width="1093.75"></p>
<pre><code>#&gt; 
#&gt; $alt$rejection</code></pre>
<p><img src="ph2rand_files/figure-html/eg44_4-12.png" width="1093.75"></p>
<pre><code>#&gt; 
#&gt; $alt$stopping</code></pre>
<p><img src="ph2rand_files/figure-html/eg44_4-13.png" width="1093.75"></p>
</div>
<div id="comparing-two-stage-designs-within-a-design-framework" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-two-stage-designs-within-a-design-framework" class="anchor"></a>4.5. Comparing two-stage designs within a design framework</h2>
<p>Finally, we consider how the choice of optimality criteria effects the optimal two-stage designs, in the framework of Jung (2008). We use the same parameters as in Section 4.4, but consider 3 possible combinations of <span class="math inline">\(w_1,\dots,w_5\)</span>, and include early stopping for efficacy</p>
<div class="sourceCode" id="cb27"><pre class="downlit">
<span class="kw">binomial_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(type     = <span class="st">"binomial"</span>,
                            alpha    = <span class="fl">0.05</span>,
                            beta     = <span class="fl">0.2</span>,
                            delta    = <span class="fl">0.25</span>,
                            ratio    = <span class="fl">2</span>,
                            Pi0      = <span class="fl">0.2</span>,
                            Pi1      = <span class="fl">0.2</span>,
                            efficacy = <span class="kw">T</span>,
                            w        = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>),
                            nCmax    = <span class="fl">30L</span>)
<span class="kw">binomial_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(type     = <span class="st">"binomial"</span>,
                            alpha    = <span class="fl">0.05</span>,
                            beta     = <span class="fl">0.2</span>,
                            delta    = <span class="fl">0.25</span>,
                            ratio    = <span class="fl">2</span>,
                            Pi0      = <span class="fl">0.2</span>,
                            Pi1      = <span class="fl">0.2</span>,
                            efficacy = <span class="kw">T</span>,
                            w        = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>),
                            nCmax    = <span class="fl">30L</span>)
<span class="kw">binomial_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/des_two_stage.html">des_two_stage</a></span>(type     = <span class="st">"binomial"</span>,
                            alpha    = <span class="fl">0.05</span>,
                            beta     = <span class="fl">0.2</span>,
                            delta    = <span class="fl">0.25</span>,
                            ratio    = <span class="fl">2</span>,
                            Pi0      = <span class="fl">0.2</span>,
                            Pi1      = <span class="fl">0.2</span>,
                            efficacy = <span class="kw">T</span>,
                            w        = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>)<span class="op">/</span><span class="fl">3</span>,
                            nCmax    = <span class="fl">30L</span>)
</pre></div>
<p>Lets compare the respective optimal designs</p>
<div class="sourceCode" id="cb28"><pre class="downlit">
<span class="kw">binomial_1</span><span class="op">$</span><span class="kw">nC</span>
<span class="co">#&gt; [1] 9 9</span>
<span class="kw">binomial_1</span><span class="op">$</span><span class="kw">boundaries</span>
<span class="co">#&gt; $e1</span>
<span class="co">#&gt; [1] 6</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $e2</span>
<span class="co">#&gt; [1] 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $f1</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $f2</span>
<span class="co">#&gt; [1] 10</span>
<span class="kw">binomial_2</span><span class="op">$</span><span class="kw">nC</span>
<span class="co">#&gt; [1] 9 9</span>
<span class="kw">binomial_2</span><span class="op">$</span><span class="kw">boundaries</span>
<span class="co">#&gt; $e1</span>
<span class="co">#&gt; [1] 6</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $e2</span>
<span class="co">#&gt; [1] 10</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $f1</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $f2</span>
<span class="co">#&gt; [1] 10</span>
<span class="kw">binomial_3</span><span class="op">$</span><span class="kw">nC</span>
<span class="co">#&gt; [1] 8 8</span>
<span class="kw">binomial_3</span><span class="op">$</span><span class="kw">boundaries</span>
<span class="co">#&gt; $e1</span>
<span class="co">#&gt; [1] 6</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $e2</span>
<span class="co">#&gt; [1] 9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $f1</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $f2</span>
<span class="co">#&gt; [1] 9</span>
</pre></div>
<p>In this case, <code>w = c(1, 0, 0, 0, 0)</code> and <code>w = c(0, 1, 0, 0, 0)</code> produce the same optimal design. Let’s compare the operating characteristics of the two distinct designs</p>
<div class="sourceCode" id="cb29"><pre class="downlit">
<span class="kw">binomial_1</span><span class="op">$</span><span class="kw">opchar</span>
<span class="co">#&gt; # A tibble: 2 x 13</span>
<span class="co">#&gt;     piC   piE `P(pi)` `ESS(pi)` `SDSS(pi)` `MSS(pi)` `E1(pi)` `E2(pi)` `F1(pi)`</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0.2  0.2   0.0488      31.4       9.99        27   0.0391  0.00974    0.797</span>
<span class="co">#&gt; 2   0.2  0.45  0.805       33.6      11.6         27   0.631   0.175      0.124</span>
<span class="co">#&gt; # … with 4 more variables: `F2(pi)` &lt;dbl&gt;, `S1(pi)` &lt;dbl&gt;, `S2(pi)` &lt;dbl&gt;, `max</span>
<span class="co">#&gt; #   N` &lt;int&gt;</span>
<span class="kw">binomial_3</span><span class="op">$</span><span class="kw">opchar</span>
<span class="co">#&gt; # A tibble: 2 x 13</span>
<span class="co">#&gt;     piC   piE `P(pi)` `ESS(pi)` `SDSS(pi)` `MSS(pi)` `E1(pi)` `E2(pi)` `F1(pi)`</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1   0.2  0.2   0.0441      35.7       12.0        24   0.0249   0.0192   0.487 </span>
<span class="co">#&gt; 2   0.2  0.45  0.814       34.7       11.9        24   0.519    0.295    0.0363</span>
<span class="co">#&gt; # … with 4 more variables: `F2(pi)` &lt;dbl&gt;, `S1(pi)` &lt;dbl&gt;, `S2(pi)` &lt;dbl&gt;, `max</span>
<span class="co">#&gt; #   N` &lt;int&gt;</span>
</pre></div>
</div>
</div>
<div id="miscellaneous" class="section level1">
<h1 class="hasAnchor">
<a href="#miscellaneous" class="anchor"></a>5. Miscellaneous</h1>
<div id="contact" class="section level2">
<h2 class="hasAnchor">
<a href="#contact" class="anchor"></a>5.1. Contact</h2>
<p>The first-line response to a possible bug should be to submit it as a <em>New issue</em> <a href="https://github.com/mjg211/ph2rand/issues">here</a>. If the issue is more complex, or a patch is not provided in reasonable time, please email <a href="mailto:michael.grayling@newcastle.ac.uk" class="email">michael.grayling@newcastle.ac.uk</a>. Similarly, please feel free to contact with suggestions for new features (see Section 5.3 for a list of current plans for new features), or for further support with using the package.</p>
</div>
<div id="citing-ph2rand" class="section level2">
<h2 class="hasAnchor">
<a href="#citing-ph2rand" class="anchor"></a>5.2. Citing <strong>ph2rand</strong>
</h2>
<p>The latest details on how to cite <strong>ph2rand</strong> can be found using <code><a href="https://rdrr.io/r/utils/citation.html">citation()</a></code></p>
<div class="sourceCode" id="cb30"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/citation.html">citation</a></span>(<span class="st">"ph2rand"</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; To cite ph2rand in publications please use</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Grayling MJ (2020) ph2rand: Design of randomized comparative phase II</span>
<span class="co">#&gt;   oncology trials with a Bernoulli distributed primary outcome. URL:</span>
<span class="co">#&gt;   http://www.github.com/mjg211/ph2rand/.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; A BibTeX entry for LaTeX users is</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   @Misc{grayling2020,</span>
<span class="co">#&gt;     title = {{ph2rand: Design of randomized comparative phase II oncology trials with a Bernoulli distributed primary outcome}},</span>
<span class="co">#&gt;     author = {Michael J. Grayling},</span>
<span class="co">#&gt;     year = {2020},</span>
<span class="co">#&gt;     url = {http://www.github.com/mjg211/ph2rand/},</span>
<span class="co">#&gt;   }</span>
</pre></div>
</div>
<div id="future-development" class="section level2">
<h2 class="hasAnchor">
<a href="#future-development" class="anchor"></a>5.3. Future development</h2>
<p>Plans are currently in place to support the following randomized comparative designs</p>
<ul>
<li>Carsten and Chen (2016).</li>
<li>Cellamare and Sambucini (2015).</li>
<li>Chen <em>et al</em> (2018).</li>
<li>Law <em>et al</em> (2020).</li>
<li>Roychoudhury <em>et al</em> (2018).</li>
<li>A design based on a normal approximation, as outlined for example in Jennison and Turnbull (2000).</li>
</ul>
<p>In addition, functions for performing post trial inference (construction of point estimates, <em>p</em>-values, and confidence intervals) in all supported designs are under development. Long-term, support for randomised designs that do not compare to a concurrent control arm, for non-Bernoulli outcome variables, and for multi-arm trials will also be added {see Grayling and Wason (2020) for some current support for multi-arm trials}.</p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>6. References</h1>
<p>Carsten C, Chen P (2016) Curtailed two-stage matched pairs design in double-arm phase II clinical trials. <em>J Biopharm Stat</em> 26(5):816–22. DOI: <a href="https://doi.org/10.1080/10543406.2015.1074921">10.1080/10543406.2015.1074921</a>.</p>
<p>Cellamare M, Sambucini V (2015) A randomized two-stage design for phase II clinical trials based on a Bayesian predictive approach. <em>Stat Med</em> 34(6):1059–78. DOI: <a href="https://doi.org/10.1002/sim.6396">10.1002/sim.6396</a>.</p>
<p>Chen CM, Chi Y, Chang HM (2018) Curtailed two-stage design for comparing two arms in randomized phase II clinical trials. <em>J Biopharm Stat</em> 28(5):939–50. DOI: <a href="https://doi.org/10.1080/10543406.2018.1428615">10.1080/10543406.2018.1428615</a>.</p>
<p>Grayling MJ, Dimairo M, Mander AP, Jaki TF (2019) A review of perspectives on the use of randomization in phase II oncology trials. <em>JNCI: J Natl Cancer I</em> 111(12):1255–62. DOI: <a href="https://doi.org/10.1093/jnci/djz126">10.1093/jnci/djz126</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31218346">31218346</a>.</p>
<p>Grayling MJ, Wason JMS (2020) A web application for the design of multi-arm clinical trials. <em>BMC Cancer</em> 20:80. DOI: <a href="https://doi.org/10.1186/s12885-020-6525-0">10.1186/s12885-020-6525-0</a>.</p>
<p>Jennison C, Turnbull B (2000) <em>Group sequential methods with applications to clinical trials</em>. Chapman &amp; Hall/CRC: Boca Raton, FL.</p>
<p>Jung SH (2008) Randomized phase II trials with a prospective control. <em>Stat Med</em> 27(4):568–83. DOI: <a href="https://doi.org/10.1002/sim.2961">10.1002/sim.2961</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/17573688">17573688</a>.</p>
<p>Jung SH (2013) <em>Randomized phase II cancer clinical trials</em>. Chapman &amp; Hall/CRC: Boca Raton, FL.</p>
<p>Jung SH, Lee T, Kim K, George SL (2004) Admissible two-stage designs for phase II cancer clinical trials. <em>Stat Med</em> 23(4):561–9. DOI: <a href="https://doi.org/10.1002/sim.1600">10.1002/sim.1600</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/14755389">14755389</a>.</p>
<p>Jung SH, Sargent DJ (2014) Randomized phase II clinical trials. <em>J Biopharm Stat</em> 24(4):802–16. DOI: <a href="https://doi.org/10.1080/10543406.2014.901343">10.1080/10543406.2014.901343</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/24697589">24697589</a>.</p>
<p>Kepner JL (2010) On group sequential designs comparing two binomial proportions. <em>J Biopharm Stat</em> 20(1):145–59. DOI: <a href="https://doi.org/10.1080/10543400903280621">10.1080/10543400903280621</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/20077254">20077254</a>.</p>
<p>Law M, Grayling MJ, Mander AP (2020) A stochastically curtailed two-arm randomised phase II trial design for binary outcomes. <em>Pharm Stat</em> DOI: <a href="https://doi.org/10.1002/pst.2067">10.1002/pst.2067</a>.</p>
<p>Litwin S, Basickes S, Ross EA (2017) Two-sample binary phase 2 trials with low type I error and low sample size. <em>Stat Med</em> 36(9):1383–94. DOI: <a href="http://doi.org/10.1002/sim.7226">10.1002/sim.7226</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/28118686">28118686</a>.</p>
<p>Mander AP, Wason JM, Sweeting MJ, Thompson SG (2012) Admissible two-stage designs for phase II cancer clinical trials that incorporate the expected sample size under the alternative hypothesis. <em>Pharm Stat</em> 11(2):91–6. DOI: <a href="https://doi.org/10.1002/pst.501">10.1002/pst.501</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/22232071">22232071</a>.</p>
<p>Roychoudhury S, Scheuer N, Neuenschwander B (2018) Beyond p-values: A phase II dual-criterion design with statistical significance and clinical relevance. <em>Clin Trials</em> 15(5):452–-61. DOI: <a href="https://doi.org/10.1177/1740774518770661">10.1177/1740774518770661</a>.</p>
<p>Shan G, Ma C, Hutson AD, Wilding GE (2013) Randomized two-stage phase II clinical trial designs based on Barnard’s exact test. <em>J Biopharm Stat</em> 23(5):1081–90. DOI: <a href="https://doi.org/10.1080/10543406.2013.813525">10.1080/10543406.2013.813525</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/23957517">23957517</a>.</p>
<p>Wason J (2015) OptGS: An R package for finding near-optimal group-sequential designs. <em>J Stat Soft</em> 66(2):1–13. DOI: <a href="https://doi.org/10.18637/jss.v066.i02">10.18637/jss.v066.i02</a>.</p>
<p>Wason JM, Mander AP, Thompson SG (2012) Optimal multistage designs for randomised clinical trials with continuous outcomes. <em>Stat Med</em> 31(4):301–12. DOI: <a href="https://doi.org/10.1002/sim.4421">10.1002/sim.4421</a>. PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/22139822">22139822</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Michael Grayling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
